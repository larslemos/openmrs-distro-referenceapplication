"use strict";(globalThis.webpackChunk_openmrs_esm_patient_chart_app=globalThis.webpackChunk_openmrs_esm_patient_chart_app||[]).push([[47],{8357:(e,t,a)=>{a.d(t,{Z:()=>s});var n=a(272),r=a.n(n),i=a(2609),o=a.n(i)()(r());o.push([e.id,":root{--brand-01: #005d5d;--brand-02: #004144;--brand-03: #007d79}.-esm-patient-chart__deceased-form__container___HMknk{margin:1rem}.-esm-patient-chart__deceased-form__container___HMknk section{margin:1rem 0}.-esm-patient-chart__deceased-form__heading___QAA4P{font-size:var(--cds-productive-heading-03-font-size, 1.25rem);font-weight:var(--cds-productive-heading-03-font-weight, 400);line-height:var(--cds-productive-heading-03-line-height, 1.4);letter-spacing:var(--cds-productive-heading-03-letter-spacing, 0);color:#525252;margin:1rem}.-esm-patient-chart__deceased-form__sectionTitle___BfE0L{font-size:var(--cds-productive-heading-02-font-size, 1rem);font-weight:var(--cds-productive-heading-02-font-weight, 600);line-height:var(--cds-productive-heading-02-line-height, 1.375);letter-spacing:var(--cds-productive-heading-02-letter-spacing, 0);color:#525252;margin:0 0 .5rem 0}.-esm-patient-chart__deceased-form__conceptAnswerOverviewWrapper___YOMx8{margin:1rem 0rem;border:.0625rem solid #e0e0e0;background-color:#f4f4f4}.-esm-patient-chart__deceased-form__conceptAnswerOverviewWrapper___YOMx8 div:nth-child(3)>div:nth-child(2){position:relative}.-esm-patient-chart__deceased-form__conceptAnswerOverviewWrapper___YOMx8 div:nth-child(3) span *{display:none}.-esm-patient-chart__deceased-form__radioButtonGroup___Q09he{display:flex;flex-direction:column;align-items:flex-start;margin-top:.5rem;min-height:4rem;width:100%;font-size:var(--cds-body-short-01-font-size, 0.875rem);font-weight:var(--cds-body-short-01-font-weight, 400);line-height:var(--cds-body-short-01-line-height, 1.28572);letter-spacing:var(--cds-body-short-01-letter-spacing, 0.16px);color:#525252;background-color:#f4f4f4}.-esm-patient-chart__deceased-form__radioButton___bZrrP{padding:.25rem 1rem;margin:.5rem 0}.-esm-patient-chart__deceased-form__contentSwitcher___oxDps{height:3rem}.-esm-patient-chart__deceased-form__headerGridRow___NgVrM{border-bottom:.0625rem solid #e0e0e0;margin:0}.-esm-patient-chart__deceased-form__dataGridRow___AM8Kq{display:grid;grid-template-columns:50% 10% 1fr;margin:.5rem 1rem;width:100%}.-esm-patient-chart__deceased-form__form___GIplW{display:flex;flex-direction:column;justify-content:space-between;height:calc(100vh - 6rem)}.-esm-patient-chart__deceased-form__button___QVKPA{height:4rem;display:flex;align-content:flex-start;align-items:baseline;min-width:50%}.-esm-patient-chart__deceased-form__conceptAnswerOverviewWrapperTablet___lWiUN{padding:1.5rem 1rem;background-color:#fff}.-esm-patient-chart__deceased-form__conceptAnswerOverviewWrapperDesktop___vojSA{padding:0rem}.-esm-patient-chart__deceased-form__conceptAnswerOverviewWrapperDesktop___vojSA .-esm-patient-chart__deceased-form__paginationContainer___Q6_S5 div{background-color:#f4f4f4}.-esm-patient-chart__deceased-form__warningContainer___AQyRx{display:flex;background-color:#fff8e1;padding:1rem;align-items:center}.-esm-patient-chart__deceased-form__warningIcon___u4DOQ{display:flex;align-self:center;fill:#f1c21b;margin-right:.5rem}.-esm-patient-chart__deceased-form__warningText___mEPjj{font-size:.875rem}","",{version:3,sources:["webpack://./../../node_modules/@openmrs/esm-styleguide/src/_vars.scss","webpack://./src/deceased/deceased-form.scss","webpack://./../../node_modules/@carbon/layout/scss/generated/_spacing.scss","webpack://./../../node_modules/@carbon/type/scss/_styles.scss"],names:[],mappings:"AAoDA,MACE,mBAAA,CACA,mBAAA,CACA,mBAAA,CClDF,sDACE,WCyBW,CDvBX,8DACE,aAAA,CAIJ,oDE6zBI,6DAAA,CAAA,6DAAA,CAAA,6DAAA,CAAA,iEAAA,CF3zBF,aDVQ,CCWR,WCeW,CDZb,yDEuzBI,0DAAA,CAAA,6DAAA,CAAA,+DAAA,CAAA,iEAAA,CFrzBF,aDhBQ,CCiBR,kBAAA,CAGF,yEACC,gBAAA,CACA,6BAAA,CACC,wBD5BM,CC+BR,2GACC,iBAAA,CAGD,iGACC,YAAA,CAGD,6DACC,YAAA,CACA,qBAAA,CACA,sBAAA,CACA,gBCtBY,CDuBZ,eCYY,CDXZ,UAAA,CE6xBG,sDAAA,CAAA,qDAAA,CAAA,yDAAA,CAAA,8DAAA,CF3xBH,aD1CS,CC2CR,wBDhDM,CCmDR,wDACC,mBAAA,CACA,cAAA,CAGD,4DACE,WCNW,CDSb,0DACE,oCAAA,CACA,QAAA,CAGF,wDACE,YAAA,CACA,iCAAA,CACA,iBAAA,CACA,UAAA,CAGF,iDACE,YAAA,CACA,qBAAA,CACA,6BAAA,CACA,yBAAA,CAGF,mDACE,WCxBW,CDyBX,YAAA,CACA,wBAAA,CACA,oBAAA,CACA,aAAA,CAGF,+EACE,mBAAA,CACA,qBDxFM,CC2FR,gFACE,YAAA,CAEA,oJACA,wBDhGM,CCoGR,6DACE,YAAA,CACA,wBDpFmB,CCqFnB,YCxEW,CDyEX,kBAAA,CAEF,wDACE,YAAA,CACA,iBAAA,CACA,YD5FmB,CC6FnB,kBCzFW,CD4Fb,wDACE,iBAAA",sourceRoot:""}]),o.locals={container:"-esm-patient-chart__deceased-form__container___HMknk",heading:"-esm-patient-chart__deceased-form__heading___QAA4P",sectionTitle:"-esm-patient-chart__deceased-form__sectionTitle___BfE0L",conceptAnswerOverviewWrapper:"-esm-patient-chart__deceased-form__conceptAnswerOverviewWrapper___YOMx8",radioButtonGroup:"-esm-patient-chart__deceased-form__radioButtonGroup___Q09he",radioButton:"-esm-patient-chart__deceased-form__radioButton___bZrrP",contentSwitcher:"-esm-patient-chart__deceased-form__contentSwitcher___oxDps",headerGridRow:"-esm-patient-chart__deceased-form__headerGridRow___NgVrM",dataGridRow:"-esm-patient-chart__deceased-form__dataGridRow___AM8Kq",form:"-esm-patient-chart__deceased-form__form___GIplW",button:"-esm-patient-chart__deceased-form__button___QVKPA",conceptAnswerOverviewWrapperTablet:"-esm-patient-chart__deceased-form__conceptAnswerOverviewWrapperTablet___lWiUN",conceptAnswerOverviewWrapperDesktop:"-esm-patient-chart__deceased-form__conceptAnswerOverviewWrapperDesktop___vojSA",paginationContainer:"-esm-patient-chart__deceased-form__paginationContainer___Q6_S5",warningContainer:"-esm-patient-chart__deceased-form__warningContainer___AQyRx",warningIcon:"-esm-patient-chart__deceased-form__warningIcon___u4DOQ",warningText:"-esm-patient-chart__deceased-form__warningText___mEPjj"};const s=o},47:(e,t,a)=>{a.r(t),a.d(t,{default:()=>G});var n=a(268),r=a.n(n),i=a(3565),o=a.n(i),s=a(4924),c=a(4350),d=a(781),l=a(906),A=a(4165),_=a(1354),m=a.n(_),u=a(1583),p=a.n(u),h=a(7378),f=a.n(h),C=a(5993),g=a.n(C),v=a(4154),w=a.n(v),D=a(8141),y=a.n(D),b=a(8357),E={};E.styleTagTransform=y(),E.setAttributes=g(),E.insert=f().bind(null,"head"),E.domAPI=p(),E.insertStyleElement=w(),m()(b.Z,E);const B=b.Z&&b.Z.locals?b.Z.locals:void 0;var k=a(6520),S=a(7279),O=a(414);function x(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}const T=function(e){var t,a,i=e.onChange,o=(e.isPatientDead,e.conceptAnswers),d=(0,s.useTranslation)().t,A="tablet"===(0,l.useLayoutType)(),_=(t=(0,n.useState)(""),a=2,function(e){if(Array.isArray(e))return e}(t)||function(e,t){var a=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=a){var n,r,i=[],o=!0,s=!1;try{for(a=a.call(e);!(o=(n=a.next()).done)&&(i.push(n.value),!t||i.length!==t);o=!0);}catch(e){s=!0,r=e}finally{try{o||null==a.return||a.return()}finally{if(s)throw r}}return i}}(t,a)||function(e,t){if(e){if("string"==typeof e)return x(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(a):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?x(e,t):void 0}}(t,a)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),m=_[0],u=_[1],p=(0,n.useMemo)((function(){return(0,S.Z)(m)?o:o.filter((function(e){return-1!==e.display.toLowerCase().search(m.toLowerCase())}))}),[m,o]),h=r().useMemo((function(){return(0,k.Z)((function(e){return u(e)}),300)}),[u]),f=(0,l.usePagination)(p,10),C=f.results,g=f.currentPage,v=f.goTo;return r().createElement("div",{className:"".concat(B.conceptAnswerOverviewWrapper," ").concat(A?B.conceptAnswerOverviewWrapperTablet:B.conceptAnswerOverviewWrapperDesktop)},r().createElement(c.Search,{onChange:function(e){return h(e.target.value)},placeholder:d("searchForCauseOfDeath","Search for a cause of death"),labelText:"",light:A}),C.length?r().createElement(r().Fragment,null,r().createElement(c.RadioButtonGroup,{className:B.radioButtonGroup,defaultSelected:"default-selected",orientation:"vertical",onChange:i,name:"radio-button-group",valueSelected:"default-selected"},null==C?void 0:C.map((function(e){var t=e.uuid,a=e.display,n=e.name;return r().createElement(c.RadioButton,{key:t,className:B.radioButton,id:n,labelText:a,value:t})}))),r().createElement("div",{className:B.paginationContainer},r().createElement(O.PatientChartPagination,{pageNumber:g,totalItems:null==o?void 0:o.length,currentItems:C.length,pageSize:10,onPageNumberChange:function(e){var t=e.page;return v(t)}}))):r().createElement(O.EmptyState,{displayText:d("causeOfDeath_title","Cause of Death"),headerTitle:d("causeOfDeath","Cause of death")}))};function W(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}function F(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var a=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=a){var n,r,i=[],o=!0,s=!1;try{for(a=a.call(e);!(o=(n=a.next()).done)&&(i.push(n.value),!t||i.length!==t);o=!0);}catch(e){s=!0,r=e}finally{try{o||null==a.return||a.return()}finally{if(s)throw r}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return W(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(a):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?W(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}const G=function(e){var t=e.patientUuid,a=e.closeWorkspace,i=(0,s.useTranslation)().t,_="tablet"===(0,l.useLayoutType)(),m=(0,n.useMemo)((function(){return{patientUuid:t}}),[t]),u=F((0,n.useState)(""),2),p=u[0],h=u[1],f=(0,A.FA)().conceptAnswers,C=(0,A.mk)(t),g=C.deathDate,v=C.isDead,w=C.isLoading,D=F((0,n.useState)(v?new Date(o()(g).year(),o()(g).month(),o()(g).date()-1):new Date),2),y=D[0],b=D[1],E=function(e){e.preventDefault(),(0,A.ZY)(y,t,p,new AbortController).then((function(e){e.ok&&((0,l.showToast)({critical:!0,kind:"success",title:i("confirmDeceased","Confirm Deceased"),description:i("setDeceasedSuccessfully","Patient has been marked dead successfully")}),a())})).catch((function(e){(0,l.showNotification)({title:i("setDeceasedError","Error marking patient deceased"),kind:"error",critical:!0,description:null==e?void 0:e.message})}))};return r().createElement(c.Form,{className:B.form},r().createElement("div",null,_&&r().createElement(c.Row,{className:B.headerGridRow},r().createElement(l.ExtensionSlot,{extensionSlotName:"visit-form-header-slot",className:B.dataGridRow,state:m})),r().createElement("div",{className:B.container},r().createElement("span",{className:B.warningContainer},r().createElement(d.Rr,{size:20,title:"WarningFilled","aria-label":"Warning",className:B.warningIcon}),r().createElement("span",{className:B.warningText},i("markingPatientDeceasedInfoText","Marking the patient as deceased will end any active visits for this patient"))),r().createElement("section",null,r().createElement("div",{className:B.sectionTitle},i("dateOfDeath","Date of Death")),f?r().createElement(c.DatePicker,{dateFormat:"d/m/Y",datePickerType:"single",id:"deceasedDate",light:_,style:{width:"100%",paddingBottom:"1rem"},maxDate:(new Date).toISOString(),onChange:function(e){var t=F(e,1)[0];return b(t)},value:y},r().createElement(c.DatePickerInput,{id:"deceasedDateInput",style:{width:"100%"},disabled:v,labelText:i("date","Date"),placeholder:"dd/mm/yyyy"})):r().createElement(c.DatePickerSkeleton,null)),r().createElement("section",null,!v&&r().createElement("div",{className:B.sectionTitle},i("causeOfDeath","Cause of death")),f?r().createElement(T,{onChange:function(e){h(e)},conceptAnswers:f,isPatientDead:v}):r().createElement("div",null,r().createElement(c.DataTableSkeleton,{columnCount:1,showToolbar:!1,showHeader:!1,rowCount:10}))))),r().createElement(c.ButtonSet,{className:_?B.tablet:B.desktop},r().createElement(c.Button,{className:B.button,kind:"secondary",onClick:a},i("discard","Discard")),r().createElement(c.Button,{onClick:function(){var e=(0,l.showModal)("confirm-deceased-dialog",{closeDialog:function(){return e()},handleSubmit:E})},className:B.button,disabled:""===p||w,kind:"primary"},i("setDeceased","Set Deceased"))))}},4165:(e,t,a)=>{a.d(t,{FA:()=>s,ZY:()=>l,mk:()=>c,sy:()=>A});var n=a(268),r=a(3255),i=a(906);function o(e,t){return null!=t&&"undefined"!=typeof Symbol&&t[Symbol.hasInstance]?!!t[Symbol.hasInstance](e):e instanceof t}function s(){var e=function(){var e=(0,r.ZP)("/ws/rest/v1/systemsetting/concept.causeOfDeath",i.openmrsFetch,{shouldRetryOnError:function(e){return o(e,Response)&&404!==e.status}}),t=e.data,a=(e.error,e.isLoading),s=e.isValidating,c=(0,n.useMemo)((function(){var e,n;return{value:null!==(n=null==t||null===(e=t.data)||void 0===e?void 0:e.value)&&void 0!==n?n:void 0,isCauseOfDeathLoading:a,isCauseOfDeathValidating:s}}),[t,a,s]);return c}(),t=e.isCauseOfDeathLoading,a=e.isCauseOfDeathValidating,s=function(e){var t,a,n=(0,r.ZP)("/ws/rest/v1/concept/".concat(e),(function(t){return e?(0,i.openmrsFetch)(t):void 0}),{shouldRetryOnError:function(e){return o(e,Response)&&404!==e.status}}),s=n.data,c=n.error,d=n.isLoading,l=n.isValidating;return{conceptAnswers:null!==(a=null==s||null===(t=s.data)||void 0===t?void 0:t.answers)&&void 0!==a?a:[],isConceptLoading:d,conceptError:c,isConceptAnswerValidating:l}}(e.value),c=s.isConceptLoading,d=s.isConceptAnswerValidating;return{conceptAnswers:s.conceptAnswers,isLoading:t||c,isValidating:d||a}}function c(e){var t,a=(0,i.usePatient)(e),n=a.isLoading,r=a.patient;return n?{deathDate:void 0,isDead:void 0,isLoading:n}:{deathDate:r.deceasedDateTime,isDead:null!==(t=r.deceasedBoolean)&&void 0!==t?t:Boolean(r.deceasedDateTime),isLoading:n}}var d=function(e,t,a){return(0,i.openmrsFetch)("/ws/rest/v1/person/".concat(e),{headers:{"Content-type":"application/json"},method:"POST",body:t,signal:a.signal})};function l(e,t,a,n){var r={causeOfDeath:a,dead:!0};return r.deathDate=e?new Date(e.getFullYear(),e.getMonth(),e.getDay()):null,d(t,r,n)}function A(e,t){return d(e,{deathDate:null,causeOfDeath:null,dead:!1},t)}}}]);