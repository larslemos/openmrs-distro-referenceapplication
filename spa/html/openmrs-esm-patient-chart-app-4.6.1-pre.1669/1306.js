"use strict";(globalThis.webpackChunk_openmrs_esm_patient_chart_app=globalThis.webpackChunk_openmrs_esm_patient_chart_app||[]).push([[1306],{1306:(e,n,a)=>{a.r(n),a.d(n,{default:()=>u});var t=a(268),i=a.n(t),s=a(4350),o=a(4924),r=a(414),d=a(4165);const u=function(e){var n=e.patientUuid,a=(0,o.useTranslation)().t,u=(0,t.useCallback)((function(){return(0,r.launchPatientWorkspace)("mark-patient-deceased-workspace-form")}),[]),c=(0,d.mk)(n),l=c.isDead;return!c.isLoading&&!l&&i().createElement(s.OverflowMenuItem,{itemText:a("markDeceased","Mark deceased"),onClick:u,style:{maxWidth:"100vw"}})}},4165:(e,n,a)=>{a.d(n,{FA:()=>r,ZY:()=>c,mk:()=>d,sy:()=>l});var t=a(268),i=a(3255),s=a(906);function o(e,n){return null!=n&&"undefined"!=typeof Symbol&&n[Symbol.hasInstance]?!!n[Symbol.hasInstance](e):e instanceof n}function r(){var e=function(){var e=(0,i.ZP)("/ws/rest/v1/systemsetting/concept.causeOfDeath",s.openmrsFetch,{shouldRetryOnError:function(e){return o(e,Response)&&404!==e.status}}),n=e.data,a=(e.error,e.isLoading),r=e.isValidating,d=(0,t.useMemo)((function(){var e,t;return{value:null!==(t=null==n||null===(e=n.data)||void 0===e?void 0:e.value)&&void 0!==t?t:void 0,isCauseOfDeathLoading:a,isCauseOfDeathValidating:r}}),[n,a,r]);return d}(),n=e.isCauseOfDeathLoading,a=e.isCauseOfDeathValidating,r=function(e){var n,a,t=(0,i.ZP)("/ws/rest/v1/concept/".concat(e),(function(n){return e?(0,s.openmrsFetch)(n):void 0}),{shouldRetryOnError:function(e){return o(e,Response)&&404!==e.status}}),r=t.data,d=t.error,u=t.isLoading,c=t.isValidating;return{conceptAnswers:null!==(a=null==r||null===(n=r.data)||void 0===n?void 0:n.answers)&&void 0!==a?a:[],isConceptLoading:u,conceptError:d,isConceptAnswerValidating:c}}(e.value),d=r.isConceptLoading,u=r.isConceptAnswerValidating;return{conceptAnswers:r.conceptAnswers,isLoading:n||d,isValidating:u||a}}function d(e){var n,a=(0,s.usePatient)(e),t=a.isLoading,i=a.patient;return t?{deathDate:void 0,isDead:void 0,isLoading:t}:{deathDate:i.deceasedDateTime,isDead:null!==(n=i.deceasedBoolean)&&void 0!==n?n:Boolean(i.deceasedDateTime),isLoading:t}}var u=function(e,n,a){return(0,s.openmrsFetch)("/ws/rest/v1/person/".concat(e),{headers:{"Content-type":"application/json"},method:"POST",body:n,signal:a.signal})};function c(e,n,a,t){var i={causeOfDeath:a,dead:!0};return i.deathDate=e?new Date(e.getFullYear(),e.getMonth(),e.getDay()):null,u(n,i,t)}function l(e,n){return u(e,{deathDate:null,causeOfDeath:null,dead:!1},n)}}}]);