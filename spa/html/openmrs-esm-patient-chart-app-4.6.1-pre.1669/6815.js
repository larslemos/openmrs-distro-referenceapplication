"use strict";(globalThis.webpackChunk_openmrs_esm_patient_chart_app=globalThis.webpackChunk_openmrs_esm_patient_chart_app||[]).push([[6815],{9143:(e,t,i)=>{i.d(t,{Z:()=>s});var n=i(272),r=i.n(n),a=i(2609),o=i.n(a)()(r());o.push([e.id,":root{--brand-01: #005d5d;--brand-02: #004144;--brand-03: #007d79}.-esm-patient-chart__visit-attribute-type__patientChartWrapper___onAM3{display:flex;position:relative}.-esm-patient-chart__visit-attribute-type__patientChartWrapper___onAM3>nav{overflow-y:scroll;padding-bottom:3rem;scrollbar-width:none}.-esm-patient-chart__visit-attribute-type__patientChartWrapper___onAM3 ::-webkit-scrollbar{width:0px;background-color:rgba(0,0,0,0)}.-esm-patient-chart__visit-attribute-type__patientChartWrapper___onAM3 .cds--side-nav__overlay-active{background-color:rgba(0,0,0,0)}.-esm-patient-chart__visit-attribute-type__caption01___VcNMe{font-size:var(--cds-legal-01-font-size, 0.75rem);font-weight:var(--cds-legal-01-font-weight, 400);line-height:var(--cds-legal-01-line-height, 1.33333);letter-spacing:var(--cds-legal-01-letter-spacing, 0.32px)}.-esm-patient-chart__visit-attribute-type__productiveHeading01___LCRo6{font-size:var(--cds-heading-compact-01-font-size, 0.875rem);font-weight:var(--cds-heading-compact-01-font-weight, 600);line-height:var(--cds-heading-compact-01-line-height, 1.28572);letter-spacing:var(--cds-heading-compact-01-letter-spacing, 0.16px)}.-esm-patient-chart__visit-attribute-type__productiveHeading02___qIuB3{font-size:var(--cds-heading-compact-02-font-size, 1rem);font-weight:var(--cds-heading-compact-02-font-weight, 600);line-height:var(--cds-heading-compact-02-line-height, 1.375);letter-spacing:var(--cds-heading-compact-02-letter-spacing, 0)}.-esm-patient-chart__visit-attribute-type__productiveHeading03___g8c6V{font-size:var(--cds-heading-03-font-size, 1.25rem);font-weight:var(--cds-heading-03-font-weight, 400);line-height:var(--cds-heading-03-line-height, 1.4);letter-spacing:var(--cds-heading-03-letter-spacing, 0)}.-esm-patient-chart__visit-attribute-type__productiveHeading04___ASZI3{font-size:var(--cds-heading-04-font-size, 1.75rem);font-weight:var(--cds-heading-04-font-weight, 400);line-height:var(--cds-heading-04-line-height, 1.28572);letter-spacing:var(--cds-heading-04-letter-spacing, 0)}.-esm-patient-chart__visit-attribute-type__bodyLong01___GhLpa{font-size:var(--cds-body-01-font-size, 0.875rem);font-weight:var(--cds-body-01-font-weight, 400);line-height:var(--cds-body-01-line-height, 1.42857);letter-spacing:var(--cds-body-01-letter-spacing, 0.16px)}.-esm-patient-chart__visit-attribute-type__bodyShort02___RrwKX{font-size:var(--cds-body-compact-02-font-size, 1rem);font-weight:var(--cds-body-compact-02-font-weight, 400);line-height:var(--cds-body-compact-02-line-height, 1.375);letter-spacing:var(--cds-body-compact-02-letter-spacing, 0)}.-esm-patient-chart__visit-attribute-type__text01___qgMzU{color:#161616}.-esm-patient-chart__visit-attribute-type__text02___qoAqp{color:#525252}.-esm-patient-chart__visit-attribute-type__label01___vezk5{font-size:var(--cds-label-01-font-size, 0.75rem);font-weight:var(--cds-label-01-font-weight, 400);line-height:var(--cds-label-01-line-height, 1.33333);letter-spacing:var(--cds-label-01-letter-spacing, 0.32px)}html[dir=rtl] .cds--date-picker-input__wrapper svg{left:1rem;right:unset}html[dir=rtl] .cds--side-nav{right:0}html[dir=rtl] .cds--side-nav .active-left-nav-link{border-right:.25rem solid var(--brand-01);border-left:unset}.-esm-patient-chart__visit-attribute-type__visitAttributeField___Z_h2J{margin-bottom:1rem}","",{version:3,sources:["webpack://./../../node_modules/@openmrs/esm-styleguide/src/_vars.scss","webpack://./src/root.scss","webpack://./../../node_modules/@carbon/type/scss/_styles.scss","webpack://./src/visit/visit-form/visit-attribute-type.scss","webpack://./../../node_modules/@carbon/layout/scss/generated/_spacing.scss"],names:[],mappings:"AAoDA,MACE,mBAAA,CACA,mBAAA,CACA,mBAAA,CCnDF,uEACE,YAAA,CACA,iBAAA,CAIA,2EACE,iBAAA,CACA,mBAAA,CACA,oBAAA,CAGF,2FACE,SAAA,CACA,8BAAA,CAEF,sGACE,8BAAA,CAIJ,6DCizBI,gDAAA,CAAA,gDAAA,CAAA,oDAAA,CAAA,yDAAA,CD7yBJ,uEC6yBI,2DAAA,CAAA,0DAAA,CAAA,8DAAA,CAAA,mEAAA,CDzyBJ,uECyyBI,uDAAA,CAAA,0DAAA,CAAA,4DAAA,CAAA,8DAAA,CDryBJ,uECqyBI,kDAAA,CAAA,kDAAA,CAAA,kDAAA,CAAA,sDAAA,CDjyBJ,uECiyBI,kDAAA,CAAA,kDAAA,CAAA,sDAAA,CAAA,sDAAA,CD7xBJ,8DC6xBI,gDAAA,CAAA,+CAAA,CAAA,mDAAA,CAAA,wDAAA,CDzxBJ,+DCyxBI,oDAAA,CAAA,uDAAA,CAAA,yDAAA,CAAA,2DAAA,CDrxBJ,0DACE,aDlDM,CCqDR,0DACE,aDrDQ,CCwDV,2DC6wBI,gDAAA,CAAA,gDAAA,CAAA,oDAAA,CAAA,yDAAA,CDtwBA,mDACE,SAAA,CACA,WAAA,CAGJ,6BACI,OAAA,CACA,mDACE,yCAAA,CACA,iBAAA,CEzER,uEACE,kBC0BW",sourceRoot:""}]),o.locals={patientChartWrapper:"-esm-patient-chart__visit-attribute-type__patientChartWrapper___onAM3",caption01:"-esm-patient-chart__visit-attribute-type__caption01___VcNMe",productiveHeading01:"-esm-patient-chart__visit-attribute-type__productiveHeading01___LCRo6",productiveHeading02:"-esm-patient-chart__visit-attribute-type__productiveHeading02___qIuB3",productiveHeading03:"-esm-patient-chart__visit-attribute-type__productiveHeading03___g8c6V",productiveHeading04:"-esm-patient-chart__visit-attribute-type__productiveHeading04___ASZI3",bodyLong01:"-esm-patient-chart__visit-attribute-type__bodyLong01___GhLpa",bodyShort02:"-esm-patient-chart__visit-attribute-type__bodyShort02___RrwKX",text01:"-esm-patient-chart__visit-attribute-type__text01___qgMzU",text02:"-esm-patient-chart__visit-attribute-type__text02___qoAqp",label01:"-esm-patient-chart__visit-attribute-type__label01___vezk5",visitAttributeField:"-esm-patient-chart__visit-attribute-type__visitAttributeField___Z_h2J"};const s=o},7002:(e,t,i)=>{i.d(t,{Z:()=>s});var n=i(272),r=i.n(n),a=i(2609),o=i.n(a)()(r());o.push([e.id,':root{--brand-01: #005d5d;--brand-02: #004144;--brand-03: #007d79}.-esm-patient-chart__visit-form__container___V0EAu{margin:1rem}.-esm-patient-chart__visit-form__container___V0EAu section{margin:1rem 0}.-esm-patient-chart__visit-form__heading___TVqyR{font-size:var(--cds-heading-03-font-size, 1.25rem);font-weight:var(--cds-heading-03-font-weight, 400);line-height:var(--cds-heading-03-line-height, 1.4);letter-spacing:var(--cds-heading-03-letter-spacing, 0);margin:1rem}.-esm-patient-chart__visit-form__sectionTitle___f3Yyk{font-size:var(--cds-heading-compact-02-font-size, 1rem);font-weight:var(--cds-heading-compact-02-font-weight, 600);line-height:var(--cds-heading-compact-02-line-height, 1.375);letter-spacing:var(--cds-heading-compact-02-letter-spacing, 0);color:#525252;margin:0 0 .5rem 0}.-esm-patient-chart__visit-form__dateTimeSection___WhhCa{display:flex}.-esm-patient-chart__visit-form__radioButton___DRhUw{margin:1rem 0}.-esm-patient-chart__visit-form__headerGridRow___xY0ZJ{border-bottom:.0625rem solid #e0e0e0;margin:0}.-esm-patient-chart__visit-form__dataGridRow___OLYdO{display:grid;grid-template-columns:50% 10% 1fr;margin:.5rem 1rem;width:100%}.-esm-patient-chart__visit-form__form___SXiaB{display:flex;flex-direction:column;justify-content:space-between;height:calc(100vh - 6rem)}.-esm-patient-chart__visit-form__button___xSg5s{height:4rem;display:flex;align-content:flex-start;align-items:baseline;min-width:50%}.-esm-patient-chart__visit-form__tablet___HslaG{padding:1.5rem 1rem;background-color:#fff}.-esm-patient-chart__visit-form__desktop___wjcUN{padding:0rem}@media screen and (max-width: 600px){.-esm-patient-chart__visit-form__dateTimeSection___WhhCa{flex-direction:column}}.-esm-patient-chart__visit-form__inlineNotification___GJdev{width:100%;max-width:unset;padding:"0rem"}.-esm-patient-chart__visit-form__queueSection___BzXv6{margin-top:.75rem}',"",{version:3,sources:["webpack://./../../node_modules/@openmrs/esm-styleguide/src/_vars.scss","webpack://./src/visit/visit-form/visit-form.scss","webpack://./../../node_modules/@carbon/layout/scss/generated/_spacing.scss","webpack://./../../node_modules/@carbon/type/scss/_styles.scss"],names:[],mappings:"AAoDA,MACE,mBAAA,CACA,mBAAA,CACA,mBAAA,CCnDF,mDACE,WC0BW,CDxBX,2DACE,aAAA,CAIJ,iDE8zBI,kDAAA,CAAA,kDAAA,CAAA,kDAAA,CAAA,sDAAA,CF3zBF,WCgBW,CDbb,sDEwzBI,uDAAA,CAAA,0DAAA,CAAA,4DAAA,CAAA,8DAAA,CFtzBF,aDfQ,CCgBR,kBAAA,CAGF,yDACE,YAAA,CAGF,qDACE,aAAA,CAGF,uDACE,oCAAA,CACA,QAAA,CAGF,qDACE,YAAA,CACA,iCAAA,CACA,iBAAA,CACA,UAAA,CAGF,8CACE,YAAA,CACA,qBAAA,CACA,6BAAA,CACA,yBAAA,CAGF,gDACE,WAAA,CACA,YAAA,CACA,wBAAA,CACA,oBAAA,CACA,aAAA,CAGF,gDACE,mBAAA,CACA,qBD5DM,CC+DR,iDACE,YAAA,CAGF,qCACE,yDACE,qBAAA,CAAA,CAIJ,4DACE,UAAA,CACA,eAAA,CACA,cAAA,CAGF,sDACE,iBCvDW",sourceRoot:""}]),o.locals={container:"-esm-patient-chart__visit-form__container___V0EAu",heading:"-esm-patient-chart__visit-form__heading___TVqyR",sectionTitle:"-esm-patient-chart__visit-form__sectionTitle___f3Yyk",dateTimeSection:"-esm-patient-chart__visit-form__dateTimeSection___WhhCa",radioButton:"-esm-patient-chart__visit-form__radioButton___DRhUw",headerGridRow:"-esm-patient-chart__visit-form__headerGridRow___xY0ZJ",dataGridRow:"-esm-patient-chart__visit-form__dataGridRow___OLYdO",form:"-esm-patient-chart__visit-form__form___SXiaB",button:"-esm-patient-chart__visit-form__button___xSg5s",tablet:"-esm-patient-chart__visit-form__tablet___HslaG",desktop:"-esm-patient-chart__visit-form__desktop___wjcUN",inlineNotification:"-esm-patient-chart__visit-form__inlineNotification___GJdev",queueSection:"-esm-patient-chart__visit-form__queueSection___BzXv6"};const s=o},6006:(e,t,i)=>{i.d(t,{Z:()=>s});var n=i(272),r=i.n(n),a=i(2609),o=i.n(a)()(r());o.push([e.id,":root{--brand-01: #005d5d;--brand-02: #004144;--brand-03: #007d79}.-esm-patient-chart__visit-type-overview__visitTypeOverviewWrapper___sN86o{margin:1rem 0rem;border:.0625rem solid #e0e0e0}.-esm-patient-chart__visit-type-overview__tablet___xom4y{background-color:#fff}.-esm-patient-chart__visit-type-overview__desktop___zxyQ_{background-color:#f4f4f4}.-esm-patient-chart__visit-type-overview__desktop___zxyQ_ .-esm-patient-chart__visit-type-overview__paginationContainer___iGHJW div{background-color:#f4f4f4}.-esm-patient-chart__visit-type-overview__visitTypeOverviewWrapper___sN86o div:nth-child(3)>div:nth-child(2){position:relative}.-esm-patient-chart__visit-type-overview__visitTypeOverviewWrapper___sN86o div:nth-child(3) span *{display:none}.-esm-patient-chart__visit-type-overview__radioButtonGroup___WkEls{display:flex;flex-direction:column;align-items:flex-start;margin-top:.5rem;min-height:4rem;width:100%;font-size:var(--cds-body-compact-01-font-size, 0.875rem);font-weight:var(--cds-body-compact-01-font-weight, 400);line-height:var(--cds-body-compact-01-line-height, 1.28572);letter-spacing:var(--cds-body-compact-01-letter-spacing, 0.16px)}.-esm-patient-chart__visit-type-overview__radioButton___fLMu4{padding:.25rem 1rem;margin:.5rem 0}","",{version:3,sources:["webpack://./../../node_modules/@openmrs/esm-styleguide/src/_vars.scss","webpack://./src/visit/visit-form/visit-type-overview.scss","webpack://./../../node_modules/@carbon/layout/scss/generated/_spacing.scss","webpack://./../../node_modules/@carbon/type/scss/_styles.scss"],names:[],mappings:"AAoDA,MACE,mBAAA,CACA,mBAAA,CACA,mBAAA,CCnDF,2EACC,gBAAA,CACA,6BAAA,CAGD,yDACC,qBDTO,CCYR,0DACC,wBDdO,CCgBP,oIACC,wBDjBM,CCqBR,6GACC,iBAAA,CAGD,mGACC,YAAA,CAGD,mEACC,YAAA,CACA,qBAAA,CACA,sBAAA,CACA,gBCZY,CDaZ,eCsBY,CDrBZ,UAAA,CEuyBG,wDAAA,CAAA,uDAAA,CAAA,2DAAA,CAAA,gEAAA,CFlyBJ,8DACC,mBAAA,CACA,cAAA",sourceRoot:""}]),o.locals={visitTypeOverviewWrapper:"-esm-patient-chart__visit-type-overview__visitTypeOverviewWrapper___sN86o",tablet:"-esm-patient-chart__visit-type-overview__tablet___xom4y",desktop:"-esm-patient-chart__visit-type-overview__desktop___zxyQ_",paginationContainer:"-esm-patient-chart__visit-type-overview__paginationContainer___iGHJW",radioButtonGroup:"-esm-patient-chart__visit-type-overview__radioButtonGroup___WkEls",radioButton:"-esm-patient-chart__visit-type-overview__radioButton___fLMu4"};const s=o},3008:(e,t,i)=>{i.d(t,{Aq:()=>c,Ls:()=>A});var n=i(5047),r=i.n(n),a=i(906);function o(e,t,i,n,r,a,o){try{var s=e[a](o),c=s.value}catch(e){return void i(e)}s.done?t(c):Promise.resolve(c).then(n,r)}function s(e){return function(){var t=this,i=arguments;return new Promise((function(n,r){var a=e.apply(t,i);function s(e){o(a,n,r,s,c,"next",e)}function c(e){o(a,n,r,s,c,"throw",e)}s(void 0)}))}}function c(e,t,i,n,r,a,o,s,c){return l.apply(this,arguments)}function l(){return(l=s(r().mark((function e(t,i,n,o,s,c,l,d,A){return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([u(d,t,i,l,A)]);case 2:return e.abrupt("return",(0,a.openmrsFetch)("/ws/rest/v1/visit-queue-entry",{method:"POST",headers:{"Content-Type":"application/json"},signal:l.signal,body:{visit:{uuid:t},queueEntry:{status:{uuid:s},priority:{uuid:o},queue:{uuid:i},patient:{uuid:n},startedAt:(0,a.toDateObjectStrict)((0,a.toOmrsIsoString)(new Date)),sortWeight:c}}}));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function u(e,t,i,n,r){return d.apply(this,arguments)}function d(){return(d=s(r().mark((function e(t,i,n,o,s){return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,a.openmrsFetch)("/ws/rest/v1/queue-entry-number?location=".concat(t,"&queue=").concat(n,"&visit=").concat(i,"&visitAttributeType=").concat(s),{method:"GET",headers:{"Content-Type":"application/json"},signal:o.signal});case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function A(e,t,i){return(0,a.openmrsFetch)("/ws/rest/v1/queue/".concat(e,"/entry/").concat(t),{method:"POST",headers:{"Content-Type":"application/json"},body:{endedAt:(0,a.toDateObjectStrict)((0,a.toOmrsIsoString)(new Date))},signal:i.signal})}},6815:(e,t,i)=>{i.r(t),i.d(t,{default:()=>ie});var n=i(268),r=i.n(n),a=i(3565),o=i.n(a),s=i(4350),c=i(4924),l=i(6839),u=i(906),d=i(414),A=i(6520),p=i(7279),m=i(1354),_=i.n(m),v=i(1583),f=i.n(v),g=i(7378),h=i.n(g),y=i(5993),b=i.n(y),C=i(4154),w=i.n(C),E=i(8141),D=i.n(E),S=i(6006),T={};T.styleTagTransform=D(),T.setAttributes=b(),T.insert=h().bind(null,"head"),T.domAPI=f(),T.insertStyleElement=w(),_()(S.Z,T);const B=S.Z&&S.Z.locals?S.Z.locals:void 0;function k(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}const x=function(e){var t,i,a=e.onChange,o=e.visitTypes,l=(0,c.useTranslation)().t,m="tablet"===(0,u.useLayoutType)(),_=(t=(0,n.useState)(""),i=2,function(e){if(Array.isArray(e))return e}(t)||function(e,t){var i=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=i){var n,r,a=[],o=!0,s=!1;try{for(i=i.call(e);!(o=(n=i.next()).done)&&(a.push(n.value),!t||a.length!==t);o=!0);}catch(e){s=!0,r=e}finally{try{o||null==i.return||i.return()}finally{if(s)throw r}}return a}}(t,i)||function(e,t){if(e){if("string"==typeof e)return k(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(i):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?k(e,t):void 0}}(t,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),v=_[0],f=_[1],g=(0,n.useMemo)((function(){return(0,p.Z)(v)?o:o.filter((function(e){return-1!==e.display.toLowerCase().search(v.toLowerCase())}))}),[v,o]),h=(0,n.useMemo)((function(){return(0,A.Z)((function(e){return f(e)}),300)}),[]),y=(0,u.usePagination)(g,5),b=y.results,C=y.currentPage,w=y.goTo;return 1===(null==b?void 0:b.length)&&a(b[0].uuid),r().createElement("div",{className:"".concat(B.visitTypeOverviewWrapper," ").concat(m?B.tablet:B.desktop)},o.length?r().createElement(r().Fragment,null,m?r().createElement(s.Layer,null,r().createElement(s.Search,{onChange:function(e){return h(e.target.value)},placeholder:l("searchForAVisitType","Search for a visit type"),labelText:""})):r().createElement(s.Search,{onChange:function(e){return h(e.target.value)},placeholder:l("searchForAVisitType","Search for a visit type"),labelText:""}),r().createElement(s.RadioButtonGroup,{className:B.radioButtonGroup,defaultSelected:1===(null==b?void 0:b.length)?b[0].uuid:"",orientation:"vertical",onChange:a,name:"radio-button-group",valueSelected:1===(null==b?void 0:b.length)?b[0].uuid:""},b.map((function(e){var t=e.uuid,i=e.display,n=e.name;return r().createElement(s.RadioButton,{key:t,className:B.radioButton,id:n,labelText:i,value:t})}))),r().createElement("div",{className:B.paginationContainer},r().createElement(d.PatientChartPagination,{pageNumber:C,totalItems:null==o?void 0:o.length,currentItems:b.length,pageSize:5,onPageNumberChange:function(e){var t=e.page;return w(t)}}))):r().createElement(s.StructuredListSkeleton,null))};var O=i(3255);function q(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var F=function(e){return t=function(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{},n=Object.keys(i);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(i).filter((function(e){return Object.getOwnPropertyDescriptor(i,e).enumerable})))),n.forEach((function(t){q(e,t,i[t])}))}return e}({},e),i=null!=(i={display:e.name})?i:{},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):function(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);i.push.apply(i,n)}return i}(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))})),t;var t,i},P=function(e){var t,i=e.patientUuid,a=e.patientProgramEnrollment,o=e.onChange,c=e.locationUuid,l=function(e,t,i,r){var a,o=(0,u.useConfig)(),s=o.visitTypeResourceUrl,c=o.showRecommendedVisitTypeTab,l="".concat(s).concat(e,"/program/").concat(i,"/enrollment/").concat(t,"?intendedLocationUuid=").concat(r),d=(0,O.ZP)(c&&e&&t&&i?l:null,u.openmrsFetch),A=d.data,p=d.error,m=d.isLoading,_=(0,n.useMemo)((function(){var e,t;return null!==(a=null==A||null===(e=A.data)||void 0===e||null===(t=e.visitTypes)||void 0===t?void 0:t.allowed.map(F))&&void 0!==a?a:[]}),[A]);return{recommendedVisitTypes:_,error:p,isLoading:m}}(i,null==a?void 0:a.uuid,null==a||null===(t=a.program)||void 0===t?void 0:t.uuid,c),d=l.recommendedVisitTypes,A=(l.error,l.isLoading);return r().createElement("div",{style:{marginTop:"0.625rem"}},A?r().createElement(s.StructuredListSkeleton,null):r().createElement(x,{onChange:o,visitTypes:d,patientUuid:i}))},I=r().memo(P),j=i(2303),L=i(9143),R={};R.styleTagTransform=D(),R.setAttributes=b(),R.insert=h().bind(null,"head"),R.domAPI=f(),R.insertStyleElement=w(),_()(L.Z,R);const N=L.Z&&L.Z.locals?L.Z.locals:void 0;function G(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function M(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var z=function(e){var t=e.attributeType,i=e.setVisitAttribute,a=e.isMissingRequiredAttributes,l=e.visitAttributes,d=e.setErrorFetchingResources,A=t.uuid,p=t.required,m=function(e){var t=(0,j.Z)("/ws/rest/v1/visitattributetype/".concat(e,"?v=").concat("custom:(uuid,display,name,description,datatypeClassname,datatypeConfig)"),u.openmrsFetch),i=t.data,r=t.error,a=t.isLoading;return(0,n.useEffect)((function(){r&&console.error(r)}),[r]),(0,n.useMemo)((function(){return{isLoading:a,error:r,data:null==i?void 0:i.data}}),[i,r,a])}(A),_=m.data,v=m.isLoading,f=m.error,g=function(e){var t=(0,j.Z)(e?"/ws/rest/v1/concept/".concat(e):null,u.openmrsFetch),i=t.data,r=t.error,a=t.isLoading;(0,n.useEffect)((function(){r&&console.error(r)}),[r]);var o=(0,n.useMemo)((function(){var e;return{isLoading:a,error:r,data:null==i?void 0:i.data,answers:null==i||null===(e=i.data)||void 0===e?void 0:e.answers}}),[i,r,a]);return o}(null==_?void 0:_.datatypeConfig),h=g.answers,y=g.isLoading,b=g.error,C=(0,c.useTranslation)().t,w=p?null==_?void 0:_.display:"".concat(null==_?void 0:_.display," (").concat(C("optional","optional"),")");(0,n.useEffect)((function(){(f||b)&&d((function(e){return{blockSavingForm:(null==e?void 0:e.blockSavingForm)||p}}))}),[b,f,p,d]);var E=(0,n.useMemo)((function(){if(v)return r().createElement(r().Fragment,null);if(f)return null;switch(null==_?void 0:_.datatypeClassname){case"org.openmrs.customdatatype.datatype.ConceptDatatype":return y?r().createElement(s.SelectSkeleton,null):b?null:r().createElement(s.Select,{labelText:w,onChange:function(e){return i(e.target.value)},required:p,invalid:p&&a&&!l[A],invalidText:C("fieldRequired","This field is required")},r().createElement(s.SelectItem,{text:C("selectAnOption","Select an option"),value:null}),h.map((function(e,t){return r().createElement(s.SelectItem,{key:t,text:e.display,value:e.uuid})})));case"org.openmrs.customdatatype.datatype.FloatDatatype":return r().createElement(s.NumberInput,{label:w,required:p,hideSteppers:!0,onChange:function(e){var t;return i(null===(t=e.target.value)||void 0===t?void 0:t.toString())},invalid:p&&a&&!l[A],invalidText:C("fieldRequired","This field is required")});case"org.openmrs.customdatatype.datatype.FreeTextDatatype":return r().createElement(s.TextInput,{labelText:w,required:p,onChange:function(e){return i(e.target.value)},invalid:p&&a&&!l[A],invalidText:C("fieldRequired","This field is required")});case"org.openmrs.customdatatype.datatype.LongFreeTextDatatype":return r().createElement(s.TextArea,{labelText:w,required:p,onChange:function(e){return i(e.target.value)},invalid:p&&a&&!l[A],invalidText:C("fieldRequired","This field is required")});case"org.openmrs.customdatatype.datatype.BooleanDatatype":return r().createElement(s.Checkbox,{labelText:w,required:p,onChange:function(e,t){var n=t.checked;return i(n.toString())},invalid:p&&a&&!l[A],invalidText:C("fieldRequired","This field is required")});case"org.openmrs.customdatatype.datatype.DateDatatype":return r().createElement(s.DatePicker,{dateFormat:"d/m/Y",datePickerType:"single",onChange:function(e){var t,n,r=(t=e,n=1,function(e){if(Array.isArray(e))return e}(t)||function(e,t){var i=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=i){var n,r,a=[],o=!0,s=!1;try{for(i=i.call(e);!(o=(n=i.next()).done)&&(a.push(n.value),!t||a.length!==t);o=!0);}catch(e){s=!0,r=e}finally{try{o||null==i.return||i.return()}finally{if(s)throw r}}return a}}(t,n)||function(e,t){if(e){if("string"==typeof e)return G(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(i):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?G(e,t):void 0}}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())[0];return i(o()(r).format("YYYY-MM-DD"))},required:p},r().createElement(s.DatePickerInput,{id:"date-picker-default-id",placeholder:"dd/mm/yyyy",labelText:w,type:"text",invalid:p&&a&&!l[A],invalidText:C("fieldRequired","This field is required")}));default:return r().createElement(s.TextInput,{labelText:w,required:p,onChange:function(e){return i(e.target.value)}})}}),[h,_,v,y,a,w,p,i,C,A,l,f,b]);return v?r().createElement("div",{className:N.visitAttributeField},r().createElement(s.TextInputSkeleton,null)):f?null:r().createElement("div",{className:N.visitAttributeField},E)};const U=function(e){var t=e.setVisitAttributes,i=e.isMissingRequiredAttributes,a=e.visitAttributes,o=e.setErrorFetchingResources,s=(0,u.useConfig)().visitAttributeTypes,c=(0,n.useCallback)((function(e,i){t((function(t){return n=function(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{},n=Object.keys(i);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(i).filter((function(e){return Object.getOwnPropertyDescriptor(i,e).enumerable})))),n.forEach((function(t){M(e,t,i[t])}))}return e}({},t),r=null!=(r=M({},e,i))?r:{},Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(r)):function(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);i.push.apply(i,n)}return i}(Object(r)).forEach((function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(r,e))})),n;var n,r}))}),[t]);return(null==s?void 0:s.length)?r().createElement(r().Fragment,null,s.map((function(e,t){return r().createElement(z,{key:t,attributeType:e,setVisitAttribute:function(t){return c(e.uuid,t)},isMissingRequiredAttributes:i,visitAttributes:a,setErrorFetchingResources:o})}))):null};var V=i(3008),W=i(7002),Z={};Z.styleTagTransform=D(),Z.setAttributes=b(),Z.insert=h().bind(null,"head"),Z.domAPI=f(),Z.insertStyleElement=w(),_()(W.Z,Z);const Y=W.Z&&W.Z.locals?W.Z.locals:void 0;function J(e){var t,i,r="/ws/rest/v1/location";e&&(r+="?q=".concat(e));var a=(0,O.ZP)(r,u.openmrsFetch),o=a.data,s=a.error,c=a.isLoading;return(0,n.useEffect)((function(){s&&console.error(s)}),[s]),{locations:null==o||null===(t=o.data)||void 0===t||null===(i=t.results)||void 0===i?void 0:i.map((function(e){return{display:e.display,uuid:e.uuid}})),isLoading:c,error:s}}var H=i(5455),Q=i.n(H);function X(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}const $=function(e){var t,i,a=e.selectedLocation,o=e.setSelectedLocation,l=((0,u.useLayoutType)(),(0,c.useTranslation)().t),d=(t=(0,n.useState)(""),i=2,function(e){if(Array.isArray(e))return e}(t)||function(e,t){var i=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=i){var n,r,a=[],o=!0,s=!1;try{for(i=i.call(e);!(o=(n=i.next()).done)&&(a.push(n.value),!t||a.length!==t);o=!0);}catch(e){s=!0,r=e}finally{try{o||null==i.return||i.return()}finally{if(s)throw r}}return a}}(t,i)||function(e,t){if(e){if("string"==typeof e)return X(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(i):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?X(e,t):void 0}}(t,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),A=d[0],p=d[1],m=(0,u.useSession)().sessionLocation,_=J(A),v=_.locations,f=(_.isLoading,_.error,function(){var e=(0,u.useConfig)().defaultFacilityUrl,t=(0,j.Z)(e,u.openmrsFetch),i=t.data,n=t.error,r=t.isLoading;return{defaultFacility:i?null==i?void 0:i.data:null,isLoading:r,isError:n}}()),g=f.defaultFacility,h=f.isLoading||Q()(g)?v||(m?[m]:[]):[g];return r().createElement("section",{"data-testid":"combo"},r().createElement("div",{className:Y.sectionTitle},l("visitLocation","Visit Location")),r().createElement("div",{className:Y.selectContainer},r().createElement(s.ComboBox,{titleText:l("selectLocation","Select a location"),"aria-label":l("selectLocation","Select a location"),id:"location",invalidText:"Required",items:h,selectedItem:null==h?void 0:h.find((function(e){return(null==e?void 0:e.uuid)===a})),onChange:function(e){var t=e.selectedItem;return o(null==t?void 0:t.uuid)},itemToString:function(e){return null==e?void 0:e.display},onInputChange:function(e){p(e)}})))};function K(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function ee(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var i=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=i){var n,r,a=[],o=!0,s=!1;try{for(i=i.call(e);!(o=(n=i.next()).done)&&(a.push(n.value),!t||a.length!==t);o=!0);}catch(e){s=!0,r=e}finally{try{o||null==i.return||i.return()}finally{if(s)throw r}}return a}}(e,t)||function(e,t){if(e){if("string"==typeof e)return K(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(i):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?K(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function te(e){var t=e.children;return e.isTablet?r().createElement(s.Layer,null,t," "):r().createElement(r().Fragment,null,t)}const ie=function(e){var t,i,a,A=e.patientUuid,p=e.closeWorkspace,m=e.promptBeforeClosing,_=(0,c.useTranslation)().t,v="tablet"===(0,u.useLayoutType)(),f=(0,u.useSession)(),g=J().error,h=null==f||null===(t=f.sessionLocation)||void 0===t?void 0:t.uuid,y=(0,u.useConfig)(),b=ee((0,n.useState)(y.showRecommendedVisitTypeTab?0:1),2),C=b[0],w=b[1],E=ee((0,n.useState)(!1),2),D=E[0],S=E[1],T=ee((0,n.useState)(!1),2),B=T[0],k=T[1],O=ee((0,n.useState)((new Date).getHours()>=12?"PM":"AM"),2),q=O[0],F=O[1],P=ee((0,n.useState)(new Date),2),j=P[0],L=P[1],R=ee((0,n.useState)(o()(new Date).format("hh:mm")),2),N=R[0],G=R[1],M=(0,n.useMemo)((function(){return{patientUuid:A}}),[A]),z=(0,d.useActivePatientEnrollment)(A),W=z.activePatientEnrollment,Z=z.isLoading,H=(0,u.useVisitTypes)(),Q=ee((0,n.useState)(W[0]),2),X=Q[0],K=Q[1],ie=(0,u.useVisit)(A).mutate,ne=ee((0,n.useState)(!0),2),re=ne[0],ae=ne[1],oe=ee((0,n.useState)({}),2),se=oe[0],ce=oe[1],le=ee((0,n.useState)(!1),2),ue=le[0],de=le[1],Ae=ee((0,n.useState)(null),2),pe=Ae[0],me=Ae[1],_e=ee((0,n.useState)((function(){return h||""})),2),ve=_e[0],fe=_e[1],ge=ee((0,n.useState)(null),2),he=ge[0],ye=ge[1],be=ee((0,n.useState)(null),2),Ce=be[0],we=be[1],Ee=(0,n.useMemo)((function(){return{patientUuid:A,setUpcomingAppointment:we}}),[A]),De=y.visitQueueNumberAttributeUuid,Se=(0,n.useCallback)((function(e){var t;if(e.preventDefault(),null===(t=y.visitAttributeTypes)||void 0===t?void 0:t.find((function(e){var t=e.uuid;return e.required&&!se[t]})))de(!0);else if(he){k(!0);var i=ee((0,d.convertTime12to24)(N,q),2),n=i[0],r=i[1],a={patient:A,startDatetime:(0,u.toDateObjectStrict)((0,u.toOmrsIsoString)(new Date(o()(j).year(),o()(j).month(),o()(j).date(),n,r))),visitType:he,location:ve,attributes:Object.entries(se).filter((function(e){var t=ee(e,2);return t[0],!!t[1]})).map((function(e){var t=ee(e,2);return{attributeType:t[0],value:t[1]}}))},s=new AbortController;(0,u.saveVisit)(a,s).pipe((0,l.P)()).subscribe((function(t){if(201===t.status){var i,a,c;if(y.showServiceQueueFields){var l,d,m,v,f,g=null===(l=null==e?void 0:e.target.queueLocation)||void 0===l?void 0:l.value,h=null===(d=null==e?void 0:e.target.service)||void 0===d?void 0:d.value,b=null===(m=null==e?void 0:e.target.priority)||void 0===m?void 0:m.value,C=null===(v=null==e?void 0:e.target.status)||void 0===v?void 0:v.value,w=null===(f=null==e?void 0:e.target.sortWeight)||void 0===f?void 0:f.value;(0,V.Aq)(t.data.uuid,h,A,b,C,w,new AbortController,g,De).then((function(e){201===e.status&&(ie(),(0,u.showToast)({kind:"success",title:_("visitStarted","Visit started"),description:_("queueAddedSuccessfully","Patient has been added to the queue successfully.","".concat(n," : ").concat(r))}))}),(function(e){(0,u.showNotification)({title:_("queueEntryError","Error adding patient to the queue"),kind:"error",critical:!0,description:null==e?void 0:e.message})}))}y.showUpcomingAppointments&&Ce&&function(e,t){return(0,u.openmrsFetch)("/ws/rest/v1/appointment",{method:"POST",signal:t.signal,headers:{"Content-Type":"application/json"},body:e})}({appointmentKind:null==Ce?void 0:Ce.appointmentKind,serviceUuid:null==Ce?void 0:Ce.service.uuid,startDateTime:null==Ce?void 0:Ce.startDateTime,endDateTime:null==Ce?void 0:Ce.endDateTime,locationUuid:ve,patientUuid:A,uuid:null==Ce?void 0:Ce.uuid,dateHonored:o()(j).format()},s).then((function(e){201===e.status&&(ie(),(0,u.showToast)({critical:!0,kind:"success",description:_("appointmentUpdate","Upcoming appointment updated successfully"),title:_("appointmentEdited","Appointment edited")}))}),(function(e){(0,u.showNotification)({title:_("updateError","Error updating upcoming appointment"),kind:"error",critical:!0,description:null==e?void 0:e.message})})),ie(),p(),(0,u.showToast)({critical:!0,kind:"success",description:_("visitStartedSuccessfully","{visit} started successfully",{visit:null!==(c=null==t||null===(i=t.data)||void 0===i||null===(a=i.visitType)||void 0===a?void 0:a.display)&&void 0!==c?c:"Visit"}),title:_("visitStarted","Visit started")})}}),(function(e){(0,u.showNotification)({title:_("startVisitError","Error starting visit"),kind:"error",critical:!0,description:null==e?void 0:e.message})}))}else S(!0)}),[p,y.visitAttributeTypes,y.showServiceQueueFields,y.showUpcomingAppointments,De,ie,A,Ce,ve,_,q,j,N,he,se,de]);return(0,n.useEffect)((function(){g&&me((function(e){return{blockSavingForm:(null==e?void 0:e.blockSavingForm)||!1}}))}),[g]),r().createElement(s.Form,{className:Y.form,onChange:function(){ae((function(e){return!e})),m((function(){return!0}))},onSubmit:Se},pe&&r().createElement(s.InlineNotification,{kind:(null==pe?void 0:pe.blockSavingForm)?"error":"warning",lowContrast:!0,className:Y.inlineNotification,title:_("partOfFormDidntLoad","Part of the form did not load"),subtitle:_("refreshToTryAgain","Please refresh to try again")}),r().createElement("div",null,v&&r().createElement(s.Row,{className:Y.headerGridRow},r().createElement(u.ExtensionSlot,{extensionSlotName:"visit-form-header-slot",className:Y.dataGridRow,state:M})),r().createElement(s.Stack,{gap:1,className:Y.container},r().createElement("section",{className:Y.section},r().createElement("div",{className:Y.sectionTitle},_("dateAndTimeOfVisit","Date and time of visit")),r().createElement("div",{className:Y.dateTimeSection},r().createElement(s.DatePicker,{dateFormat:"d/m/Y",datePickerType:"single",id:"visitDate",light:v,style:{paddingBottom:"1rem"},maxDate:(new Date).toISOString(),onChange:function(e){var t=ee(e,1)[0];return L(t)},value:j},r().createElement(s.DatePickerInput,{id:"visitStartDateInput",labelText:_("date","Date"),placeholder:"dd/mm/yyyy",style:{width:"100%"}})),r().createElement(te,{isTablet:v},r().createElement(s.TimePicker,{id:"visitStartTime",labelText:_("time","Time"),onChange:function(e){return G(e.target.value)},pattern:"^(1[0-2]|0?[1-9]):([0-5]?[0-9])$",style:{marginLeft:"0.125rem",flex:"none"},value:N},r().createElement(s.TimePickerSelect,{id:"visitStartTimeSelect",onChange:function(e){return F(e.target.value)},value:q,"aria-label":_("time","Time")},r().createElement(s.SelectItem,{value:"AM",text:"AM"}),r().createElement(s.SelectItem,{value:"PM",text:"PM"})))))),y.showUpcomingAppointments&&r().createElement(u.ExtensionSlot,{state:Ee,extensionSlotName:"upcoming-appointment-slot"}),r().createElement($,{selectedLocation:ve,setSelectedLocation:fe}),y.showRecommendedVisitTypeTab&&r().createElement("section",null,r().createElement("div",{className:Y.sectionTitle},_("program","Program")),r().createElement(s.FormGroup,{legendText:_("selectProgramType","Select program type")},r().createElement(s.RadioButtonGroup,{defaultSelected:null!==(a=null==X||null===(i=X.program)||void 0===i?void 0:i.uuid)&&void 0!==a?a:"",orientation:"vertical",onChange:function(e){return K(W.find((function(t){return t.program.uuid===e})))},name:"program-type-radio-group"},W.map((function(e){var t=e.uuid,i=e.display,n=e.program;return r().createElement(s.RadioButton,{key:t,className:Y.radioButton,id:t,labelText:i,value:n.uuid})}))))),r().createElement("section",null,r().createElement("div",{className:Y.sectionTitle},_("visitType_title","Visit Type")),y.showRecommendedVisitTypeTab?r().createElement(r().Fragment,null,r().createElement(s.ContentSwitcher,{selectedIndex:C,onChange:function(e){var t=e.index;return w(t)}},r().createElement(s.Switch,{name:"recommended",text:_("recommended","Recommended")}),r().createElement(s.Switch,{name:"all",text:_("all","All")})),0===C&&!Z&&r().createElement(I,{onChange:function(e){ye(e),S(!1)},patientUuid:A,patientProgramEnrollment:X,locationUuid:ve}),1===C&&r().createElement(x,{onChange:function(e){ye(e),S(!1)},visitTypes:H,patientUuid:A})):r().createElement(x,{onChange:function(e){ye(e),S(!1)},visitTypes:H,patientUuid:A})),D&&r().createElement("section",null,r().createElement(s.InlineNotification,{role:"alert",style:{margin:"0",minWidth:"100%"},kind:"error",lowContrast:!0,title:_("missingVisitType","Missing visit type"),subtitle:_("selectVisitType","Please select a Visit Type")})),r().createElement("section",null,r().createElement(U,{setVisitAttributes:ce,isMissingRequiredAttributes:ue,visitAttributes:se,setErrorFetchingResources:me})),y.showServiceQueueFields&&r().createElement(u.ExtensionSlot,{extensionSlotName:"add-queue-entry-slot"}))),r().createElement(s.ButtonSet,{className:v?Y.tablet:Y.desktop},r().createElement(s.Button,{className:Y.button,kind:"secondary",onClick:function(){return p(re)}},_("discard","Discard")),r().createElement(s.Button,{className:Y.button,disabled:B||(null==pe?void 0:pe.blockSavingForm),kind:"primary",type:"submit"},_("startVisit","Start visit"))))}}}]);