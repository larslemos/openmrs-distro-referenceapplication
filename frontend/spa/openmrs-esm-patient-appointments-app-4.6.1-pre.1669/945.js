(globalThis.webpackChunk_openmrs_esm_patient_appointments_app=globalThis.webpackChunk_openmrs_esm_patient_appointments_app||[]).push([[945],{6824:function(t){t.exports=function(){"use strict";return function(t,n,e){n.prototype.isToday=function(){var t="YYYY-MM-DD",n=e();return this.format(t)===n.format(t)}}}()},7945:(t,n,e)=>{"use strict";e.r(n),e.d(n,{default:()=>m});var r=e(5047),a=e.n(r),o=e(7900),i=e.n(o),l=e(4924),s=e(7495),u=e(906),c=e(6636);function p(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}function d(t,n,e,r,a,o,i){try{var l=t[o](i),s=l.value}catch(t){return void e(t)}l.done?n(s):Promise.resolve(s).then(r,a)}const m=function(t){var n,e,r,m,f=t.closeCancelModal,v=t.appointmentUuid,h=t.patientUuid,y=(0,l.useTranslation)().t,w=(0,c.zt)(h,(new Date).toUTCString(),new AbortController).mutate,g=(r=(0,o.useState)(!1),m=2,function(t){if(Array.isArray(t))return t}(r)||function(t,n){var e=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=e){var r,a,o=[],i=!0,l=!1;try{for(e=e.call(t);!(i=(r=e.next()).done)&&(o.push(r.value),!n||o.length!==n);i=!0);}catch(t){l=!0,a=t}finally{try{i||null==e.return||e.return()}finally{if(l)throw a}}return o}}(r,m)||function(t,n){if(t){if("string"==typeof t)return p(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(e):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?p(t,n):void 0}}(r,m)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),T=g[0],D=g[1],C=(n=a().mark((function t(){var n;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=new AbortController,D(!0),(0,c.v1)("Cancelled",v,n).then((function(t){200===t.status&&(w(),f(),(0,u.showToast)({critical:!0,kind:"success",description:y("appointmentCancelledSuccessfully","Appointment cancelled successfully"),title:y("appointmentCancelled","Appointment cancelled")}))})).catch((function(t){(0,u.showNotification)({title:y("appointmentCancelError","Error cancelling appointment"),kind:"error",critical:!0,description:null==t?void 0:t.message})}));case 3:case"end":return t.stop()}}),t)})),e=function(){var t=this,e=arguments;return new Promise((function(r,a){var o=n.apply(t,e);function i(t){d(o,r,a,i,l,"next",t)}function l(t){d(o,r,a,i,l,"throw",t)}i(void 0)}))},function(){return e.apply(this,arguments)});return i().createElement("div",null,i().createElement(s.xBx,{closeModal:f,title:y("cancelAppointment","Cancel appointment")}),i().createElement(s.fef,null,i().createElement("p",null,y("cancelAppointmentModalConfirmationText","Are you sure you want to cancel this appointment?"))),i().createElement(s.mzw,null,i().createElement(s.zxk,{kind:"secondary",onClick:f},y("discard","Discard")),i().createElement(s.zxk,{kind:"danger",onClick:C,disabled:T},y("cancelAppointment","Cancel appointment"))))}},6636:(t,n,e)=>{"use strict";e.d(n,{Ae:()=>h,GB:()=>v,l9:()=>f,v1:()=>g,zt:()=>m});var r=e(5047),a=e.n(r),o=e(3565),i=e.n(o),l=e(3255),s=e(906),u=e(6824),c=e.n(u);function p(t,n,e,r,a,o,i){try{var l=t[o](i),s=l.value}catch(t){return void e(t)}l.done?n(s):Promise.resolve(s).then(r,a)}i().extend(c());var d="/ws/rest/v1/appointments/search";function m(t,n,e){var r,a,o,u,c,p,m,f=(0,l.ZP)(d,(function(){return(0,s.openmrsFetch)(d,{method:"POST",signal:e.signal,headers:{"Content-Type":"application/json"},body:{patientUuid:t,startDate:n}})})),v=f.data,h=f.error,y=f.isLoading,w=f.isValidating,g=f.mutate,T=(null==v||null===(r=v.data)||void 0===r?void 0:r.length)?v.data:null,D=null===(o=null===(a=null==T?void 0:T.sort((function(t,n){return n.startDateTime>t.startDateTime?1:-1})))||void 0===a?void 0:a.filter((function(t){return"Cancelled"!==t.status})))||void 0===o?void 0:o.filter((function(t){var n=t.startDateTime;return i()(new Date(n).toISOString()).isBefore((new Date).setHours(0,0,0,0))})),C=null===(c=null===(u=null==T?void 0:T.sort((function(t,n){return t.startDateTime>n.startDateTime?1:-1})))||void 0===u?void 0:u.filter((function(t){return"Cancelled"!==t.status})))||void 0===c?void 0:c.filter((function(t){var n=t.startDateTime;return i()(new Date(n).toISOString()).isAfter(new Date)})),S=null===(m=null===(p=null==T?void 0:T.sort((function(t,n){return t.startDateTime>n.startDateTime?1:-1})))||void 0===p?void 0:p.filter((function(t){return"Cancelled"!==t.status})))||void 0===m?void 0:m.filter((function(t){var n=t.startDateTime;return i()(new Date(n).toISOString()).isToday()}));return{data:v?{pastAppointments:D,upcomingAppointments:C,todaysAppointments:S}:null,isError:h,isLoading:y,isValidating:w,mutate:g}}function f(){var t=(0,l.ZP)("/ws/rest/v1/appointmentService/all/full",s.openmrsFetch),n=t.data,e=t.error,r=t.isLoading;return{data:n?n.data:null,isError:e,isLoading:r}}function v(t,n){return(0,s.openmrsFetch)("/ws/rest/v1/appointment",{method:"POST",signal:n.signal,headers:{"Content-Type":"application/json"},body:t})}function h(t,n){return(0,s.openmrsFetch)("/ws/rest/v1/recurring-appointments",{method:"POST",signal:n.signal,headers:{"Content-Type":"application/json"},body:t})}var y,w,g=(y=a().mark((function t(n,e,r){var o,l,u;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=Intl.DateTimeFormat().resolvedOptions().timeZone,l=i()(new Date).format("YYYY-MM-DDTHH:mm:ss.SSSZZ"),u="/ws/rest/v1/appointments/".concat(e,"/status-change"),t.next=6,(0,s.openmrsFetch)(u,{body:{toStatus:n,onDate:l,timeZone:o},method:"POST",headers:{"Content-Type":"application/json"}});case 6:return t.abrupt("return",t.sent);case 7:case"end":return t.stop()}}),t)})),w=function(){var t=this,n=arguments;return new Promise((function(e,r){var a=y.apply(t,n);function o(t){p(a,e,r,o,i,"next",t)}function i(t){p(a,e,r,o,i,"throw",t)}o(void 0)}))},function(t,n,e){return w.apply(this,arguments)})}}]);