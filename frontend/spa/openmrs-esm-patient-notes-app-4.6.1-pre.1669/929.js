"use strict";(globalThis.webpackChunk_openmrs_esm_patient_notes_app=globalThis.webpackChunk_openmrs_esm_patient_notes_app||[]).push([[929],{5739:(e,t,n)=>{n.d(t,{Z:()=>s});var r=n(272),o=n.n(r),a=n(2609),i=n.n(a)()(o());i.push([e.id,":root{--brand-01: #005d5d;--brand-02: #004144;--brand-03: #007d79}.-esm-patient-notes__notes-overview__widgetCard___birMz{border:1px solid #e0e0e0}.-esm-patient-notes__notes-overview__expandedRow___v_Gc7>td{padding-left:2.5rem !important}.-esm-patient-notes__notes-overview__expandedRow___v_Gc7>td>div{max-height:max-content !important}.-esm-patient-notes__notes-overview__expandedRow___v_Gc7 th[colspan] td[colspan]>div:first-child{padding:0 1rem}.-esm-patient-notes__notes-overview__copy___ZJPsO{font-size:var(--cds-body-01-font-size, 0.875rem);font-weight:var(--cds-body-01-font-weight, 400);line-height:var(--cds-body-01-line-height, 1.42857);letter-spacing:var(--cds-body-01-letter-spacing, 0.16px);display:flex;flex-direction:column}.-esm-patient-notes__notes-overview__container___n8apy{margin:.5rem}.-esm-patient-notes__notes-overview__metadata___sFTBw{font-size:var(--cds-label-01-font-size, 0.75rem);font-weight:var(--cds-label-01-font-weight, 400);line-height:var(--cds-label-01-line-height, 1.33333);letter-spacing:var(--cds-label-01-letter-spacing, 0.32px);color:#525252;margin:.5rem 0}.-esm-patient-notes__notes-overview__hiddenRow___zo2KM{display:none}","",{version:3,sources:["webpack://./../../node_modules/@openmrs/esm-styleguide/src/_vars.scss","webpack://./src/notes/notes-overview.scss","webpack://./../../node_modules/@carbon/type/scss/_styles.scss"],names:[],mappings:"AAoDA,MACE,mBAAA,CACA,mBAAA,CACA,mBAAA,CCnDF,wDACE,wBAAA,CAGF,4DACE,8BAAA,CAGF,gEACE,iCAAA,CAGF,iGACE,cAAA,CAGF,kDCszBI,gDAAA,CAAA,+CAAA,CAAA,mDAAA,CAAA,wDAAA,CDnzBF,YAAA,CACA,qBAAA,CAGF,uDACE,YAAA,CAGF,sDC2yBI,gDAAA,CAAA,gDAAA,CAAA,oDAAA,CAAA,yDAAA,CDzyBF,aD5BQ,CC6BR,cAAA,CAGF,uDACE,YAAA",sourceRoot:""}]),i.locals={widgetCard:"-esm-patient-notes__notes-overview__widgetCard___birMz",expandedRow:"-esm-patient-notes__notes-overview__expandedRow___v_Gc7",copy:"-esm-patient-notes__notes-overview__copy___ZJPsO",container:"-esm-patient-notes__notes-overview__container___n8apy",metadata:"-esm-patient-notes__notes-overview__metadata___sFTBw",hiddenRow:"-esm-patient-notes__notes-overview__hiddenRow___zo2KM"};const s=i},4929:(e,t,n)=>{n.d(t,{Z:()=>q});var r=n(268),o=n.n(r),a=n(4924),i=n(4356),s=n(6759),l=n(906),c=n(6217),u=n(9202),d=n(5598),p=n(9523),v=n(4310);const m=function(e,t,n){for(var r=-1,o=Object(e),a=n(e),i=a.length;i--;){var s=a[++r];if(!1===t(o[s],s,o))break}return e};var f=n(4753);var g=n(3282);const A=(_=function(e,t){return e&&m(e,t,f.Z)},function(e,t){if(null==e)return e;if(!(0,g.Z)(e))return _(e,t);for(var n=e.length,r=-1,o=Object(e);++r<n&&!1!==t(o[r],r,o););return e});var _;var y=n(3225),b=n(2758);const h=function(e,t){if(e!==t){var n=void 0!==e,r=null===e,o=e==e,a=(0,b.Z)(e),i=void 0!==t,s=null===t,l=t==t,c=(0,b.Z)(t);if(!s&&!c&&!a&&e>t||a&&i&&l&&!s&&!c||r&&i&&l||!n&&l||!o)return 1;if(!r&&!a&&!c&&e<t||c&&n&&o&&!r&&!a||s&&n&&o||!i&&o||!l)return-1}return 0};var w=n(9930),C=n(7885);const E=function(e,t,n){t=t.length?(0,d.Z)(t,(function(e){return(0,C.Z)(e)?function(t){return(0,p.Z)(t,1===e.length?e[0]:e)}:e})):[w.Z];var r=-1;t=(0,d.Z)(t,(0,y.Z)(v.Z));var o=function(e,t){var n=-1,r=(0,g.Z)(e)?Array(e.length):[];return A(e,(function(e,o,a){r[++n]=t(e,o,a)})),r}(e,(function(e,n,o){return{criteria:(0,d.Z)(t,(function(t){return t(e)})),index:++r,value:e}}));return function(e,t){var n=e.length;for(e.sort(t);n--;)e[n]=e[n].value;return e}(o,(function(e,t){return function(e,t,n){for(var r=-1,o=e.criteria,a=t.criteria,i=o.length,s=n.length;++r<i;){var l=h(o[r],a[r]);if(l)return r>=s?l:l*("desc"==n[r]?-1:1)}return e.index-t.index}(e,t,n)}))},D=function(e,t,n,r){return null==e?[]:((0,C.Z)(t)||(t=null==t?[]:[t]),n=r?void 0:n,(0,C.Z)(n)||(n=null==n?[]:[n]),E(e,t,n))};var O=n(1354),P=n.n(O),k=n(1583),S=n.n(k),j=n(7378),T=n.n(j),x=n(5993),N=n.n(x),Z=n(4154),R=n.n(Z),z=n(8141),F=n.n(z),B=n(5739),L={};L.styleTagTransform=F(),L.setAttributes=N(),L.insert=T().bind(null,"head"),L.domAPI=S(),L.insertStyleElement=R(),P()(B.Z,L);const G=B.Z&&B.Z.locals?B.Z.locals:void 0;function I(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function V(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function M(){return M=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},M.apply(this,arguments)}const U=function(e){var t,n,s=e.notes,u=e.pageSize,d=e.pageUrl,p=e.urlLabel,v=(0,a.useTranslation)().t,m="tablet"===(0,l.useLayoutType)(),f=(t=(0,r.useState)({key:"",order:"none"}),n=2,function(e){if(Array.isArray(e))return e}(t)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a=[],i=!0,s=!1;try{for(n=n.call(e);!(i=(r=n.next()).done)&&(a.push(r.value),!t||a.length!==t);i=!0);}catch(e){s=!0,o=e}finally{try{i||null==n.return||n.return()}finally{if(s)throw o}}return a}}(t,n)||function(e,t){if(e){if("string"==typeof e)return I(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?I(e,t):void 0}}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),g=f[0],A=f[1],_=[{key:"encounterDate",header:v("date","Date")},{key:"diagnoses",header:v("diagnoses","Diagnoses")}],y=g.key,b=g.order,h="encounterDate"===y?function(e,t){return D(e,[function(e){return new Date(e.encounterDate).getTime()}],"ASC"===t?["desc"]:["asc"])}(s,b):D(s,[y],"DESC"===b?["desc"]:["asc"]),w=(0,l.usePagination)(h,u),C=w.results,E=w.goTo,O=w.currentPage,P=o().useMemo((function(){return null==C?void 0:C.map((function(e){return t=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){V(e,t,n[t])}))}return e}({},e),n=null!=(n={id:"".concat(e.id),encounterDate:(0,l.formatDate)((0,l.parseDate)(e.encounterDate),{mode:"wide"}),diagnoses:e.diagnoses?e.diagnoses:"--"})?n:{},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n}(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})),t;var t,n}))}),[C]);return o().createElement(o().Fragment,null,o().createElement(i.wQF,{rows:P,sortRow:function(e,t,n){var r=n.sortDirection,o=(n.sortStates,function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(n,["sortDirection","sortStates"]).key);A({key:o,order:r})},headers:_,isSortable:!0,size:m?"lg":"sm",useZebraStyles:!0},(function(e){var t=e.rows,n=e.headers,r=e.getExpandHeaderProps,a=e.getTableProps,s=e.getTableContainerProps,c=e.getHeaderProps,u=e.getRowProps;return o().createElement(i.xJi,M({},s),o().createElement(i.iA_,M({},a()),o().createElement(i.ssF,null,o().createElement(i.SCH,null,o().createElement(i.MOD,M({enableToggle:!0},r())),n.map((function(e,t){return o().createElement(i.xDH,M({key:t,className:"".concat(G.productiveHeading01," ").concat(G.text02)},c({header:e})),e.header)})))),o().createElement(i.RMI,null,t.map((function(e,t){var r,a,s,c,d;return o().createElement(o().Fragment,{key:e.id},o().createElement(i.RcE,M({},u({row:e})),e.cells.map((function(e){return o().createElement(i.pj1,{key:e.id},e.value)}))),e.isExpanded?o().createElement(i.WdL,{className:G.expandedRow,colSpan:n.length+1},o().createElement("div",{className:G.container,key:t},(null==P||null===(r=P[t])||void 0===r?void 0:r.encounterNote)?o().createElement("div",{className:G.copy},o().createElement("span",{className:G.content},null==P||null===(a=P[t])||void 0===a?void 0:a.encounterNote),o().createElement("span",{className:G.metadata},(0,l.formatTime)(new Date(null==P||null===(s=P[t])||void 0===s?void 0:s.encounterNoteRecordedAt))," Â·"," ",null==P||null===(c=P[t])||void 0===c?void 0:c.encounterProvider,", ",null==P||null===(d=P[t])||void 0===d?void 0:d.encounterProviderRole)):o().createElement("span",{className:G.copy},v("noVisitNoteToDisplay","No visit note to display")))):o().createElement(i.WdL,{className:G.hiddenRow,colSpan:n.length+2}))})))))})),o().createElement(c.PatientChartPagination,{pageNumber:O,totalItems:s.length,currentItems:C.length,pageSize:u,onPageNumberChange:function(e){var t=e.page;return E(t)},dashboardLinkUrl:d,dashboardLinkLabel:p}))};function H(){return H=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},H.apply(this,arguments)}const q=function(e){var t=e.patientUuid,n=e.showAddNote,r=e.pageSize,d=e.urlLabel,p=e.pageUrl,v=(0,a.useTranslation)().t,m=(0,l.useVisit)(t).currentVisit,f=v("visitNotes","Visit notes"),g=v("visitNotes","Visit notes"),A=(0,u.q6)(t),_=A.visitNotes,y=A.isError,b=A.isLoading,h=A.isValidating,w=(0,l.useLayoutType)(),C="large-desktop"===w||"small-desktop"===w,E=o().useCallback((function(){m?(0,c.launchPatientWorkspace)("visit-notes-form-workspace"):(0,c.launchStartVisitPrompt)()}),[m]);return b?o().createElement(i.gqd,{role:"progressbar",compact:C,zebra:!0}):y?o().createElement(c.ErrorState,{error:y,headerTitle:g}):(null==_?void 0:_.length)?o().createElement("div",{className:G.widgetCard},o().createElement(c.CardHeader,{title:g},o().createElement("span",null,h?o().createElement(i.lSo,null):null),n&&o().createElement(i.zxk,{kind:"ghost",renderIcon:function(e){return o().createElement(s.mm,H({size:16},e))},iconDescription:"Add visit note",onClick:E},v("add","Add"))),o().createElement(U,{notes:_,pageSize:r,urlLabel:d,pageUrl:p})):o().createElement(c.EmptyState,{displayText:f,headerTitle:g,launchForm:E})}},9202:(e,t,n)=>{n.d(t,{BH:()=>c,Ti:()=>s,aH:()=>l,q6:()=>i});var r=n(3255),o=n(2188),a=n(906);function i(e){var t,n,o,i=(0,a.useConfig)().visitNoteConfig,s=i.encounterNoteTextConceptUuid,l=i.visitDiagnosesConceptUuid,c="/ws/rest/v1/encounter?patient=".concat(e,"&obs=").concat(l,"&v=").concat("custom:(uuid,display,encounterDatetime,patient,obs,encounterProviders:(uuid,display,encounterRole:(uuid,display),provider:(uuid,person:(uuid,display))),diagnoses"),u=(0,r.ZP)(c,a.openmrsFetch),d=u.data,p=u.error,v=u.isLoading,m=u.isValidating,f=u.mutate,g=null===(o=null==d||null===(t=d.data)||void 0===t||null===(n=t.results)||void 0===n?void 0:n.map((function(e,t){var n,r,o,a,i,l,c;return{id:"".concat(t),diagnoses:e.diagnoses.map((function(e){return e.display})).filter((function(e){return e})).join(", "),encounterDate:e.encounterDatetime,encounterNote:null===(n=e.obs.find((function(e){return e.concept.uuid===s})))||void 0===n?void 0:n.value,encounterNoteRecordedAt:null===(r=e.obs.find((function(e){return e.concept.uuid===s})))||void 0===r?void 0:r.obsDatetime,encounterProvider:null===(o=null==e?void 0:e.encounterProviders[0])||void 0===o||null===(a=o.provider)||void 0===a||null===(i=a.person)||void 0===i?void 0:i.display,encounterProviderRole:null===(l=null==e?void 0:e.encounterProviders[0])||void 0===l||null===(c=l.encounterRole)||void 0===c?void 0:c.display}})))||void 0===o?void 0:o.sort((function(e,t){return new Date(t.encounterDate).getTime()-new Date(e.encounterDate).getTime()}));return{visitNotes:d?g:null,isError:p,isLoading:v,isValidating:m,mutateVisitNotes:f}}function s(e){return(0,a.openmrsObservableFetch)("/ws/rest/v1/concept?q=".concat(e,"&searchType=fuzzy&class=8d4918b0-c2cc-11de-8d13-0010c6dffd0f&q=&v=custom:(uuid,display)")).pipe((0,o.U)((function(e){return e.data.results})))}function l(e,t){return(0,a.openmrsFetch)("/ws/rest/v1/encounter",{headers:{"Content-Type":"application/json"},method:"POST",body:t,signal:e.signal})}function c(e,t){return(0,a.openmrsFetch)("/ws/rest/v1/patientdiagnoses",{headers:{"Content-Type":"application/json"},method:"POST",body:t})}}}]);