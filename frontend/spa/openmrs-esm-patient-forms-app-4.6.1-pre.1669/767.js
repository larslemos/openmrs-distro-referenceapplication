"use strict";(globalThis.webpackChunk_openmrs_esm_patient_forms_app=globalThis.webpackChunk_openmrs_esm_patient_forms_app||[]).push([[767],{2924:(e,t,n)=>{n.d(t,{Z:()=>i});var r=n(272),o=n.n(r),s=n(2609),a=n.n(s)()(o());a.push([e.id,".omrs-breakpoint-gt-tablet .-esm-patient-forms__forms-dashboard__container___jHiRr{margin:0}.omrs-breakpoint-lt-desktop .-esm-patient-forms__forms-dashboard__container___jHiRr{margin:1rem}","",{version:3,sources:["webpack://./src/forms/forms-dashboard.scss"],names:[],mappings:"AAEE,mFACE,QAAA,CAMF,oFACE,WAAA",sourceRoot:""}]),a.locals={container:"-esm-patient-forms__forms-dashboard__container___jHiRr"};const i=a},6726:(e,t,n)=>{n.d(t,{Z:()=>i});var r=n(272),o=n.n(r),s=n(2609),a=n.n(s)()(o());a.push([e.id,':root{--brand-01: #005d5d;--brand-02: #004144;--brand-03: #007d79}.-esm-patient-forms__forms-list__container___xgwVa{padding:2rem;background-color:#f4f4f4}.-esm-patient-forms__forms-list__backgroundDataFetchingIndicator___sBW6B{flex:1}.-esm-patient-forms__forms-list__flexContainer___kG5Iq{display:flex;justify-content:space-between}.-esm-patient-forms__forms-list__toolbarWrapper___ZzsNI{position:relative;display:flex;height:3rem;justify-content:flex-end}.-esm-patient-forms__forms-list__tableToolbar___ObNDb{width:20%;min-width:12.5rem}.-esm-patient-forms__forms-list__search___hzYIS input{padding:0 4rem !important}.-esm-patient-forms__forms-list__search___hzYIS .cds--search-close:focus{outline:none;outline-offset:0}.-esm-patient-forms__forms-list__search___hzYIS .cds--search-close:focus:before{background-color:none}.-esm-patient-forms__forms-list__table___QQOPl tr:last-of-type td{border-bottom:none}.-esm-patient-forms__forms-list__heading___CM6tO{margin-bottom:1.5rem}.-esm-patient-forms__forms-list__toolbar___sm5JG{position:relative;display:flex;width:100%;min-height:3rem;margin-bottom:.5rem}.-esm-patient-forms__forms-list__emptyContainer___MAOhX{justify-content:center;align-items:center;width:100%;padding:1rem}.-esm-patient-forms__forms-list__tableContainer___wBefR{padding:0}.-esm-patient-forms__forms-list__tableContainer___wBefR .cds--data-table-content{border:1px solid #e0e0e0;border-bottom:none;overflow:visible}.-esm-patient-forms__forms-list__tableContainer___wBefR .cds--table-toolbar{position:relative;height:2rem;min-height:0rem;overflow:visible;top:0}.-esm-patient-forms__forms-list__tableContainer___wBefR.cds--data-table-container{padding-top:0rem}.-esm-patient-forms__forms-list__filterContainer___MGW4a{flex:1}.-esm-patient-forms__forms-list__filterContainer___MGW4a .cds--dropdown__wrapper--inline{gap:0}.-esm-patient-forms__forms-list__filterContainer___MGW4a .cds--list-box__menu-icon{height:1rem}.-esm-patient-forms__forms-list__tileContainer___INhlH{background-color:#fff;border-top:1px solid #e0e0e0;padding:5rem 0}.-esm-patient-forms__forms-list__tile___hxTl4{margin:auto;width:fit-content}.-esm-patient-forms__forms-list__content___ESb5d{font-size:var(--cds-heading-compact-02-font-size, 1rem);font-weight:var(--cds-heading-compact-02-font-weight, 600);line-height:var(--cds-heading-compact-02-line-height, 1.375);letter-spacing:var(--cds-heading-compact-02-letter-spacing, 0);color:#525252;margin-bottom:.5rem}.-esm-patient-forms__forms-list__tileContent___DjLG8{display:flex;flex-direction:column;align-items:center}.-esm-patient-forms__forms-list__emptyState___msVPw{text-align:center;border:1px solid #e0e0e0}.-esm-patient-forms__forms-list__emptyStateContent___D36gX{font-size:var(--cds-heading-compact-01-font-size, 0.875rem);font-weight:var(--cds-heading-compact-01-font-weight, 600);line-height:var(--cds-heading-compact-01-line-height, 1.28572);letter-spacing:var(--cds-heading-compact-01-letter-spacing, 0.16px);color:#525252;margin-top:1rem;margin-bottom:.5rem}.-esm-patient-forms__forms-list__desktopHeading___H0ZOv h4{font-size:var(--cds-heading-compact-02-font-size, 1rem);font-weight:var(--cds-heading-compact-02-font-weight, 600);line-height:var(--cds-heading-compact-02-line-height, 1.375);letter-spacing:var(--cds-heading-compact-02-letter-spacing, 0);color:#525252}.-esm-patient-forms__forms-list__tabletHeading___WoN_X h4{font-size:var(--cds-heading-03-font-size, 1.25rem);font-weight:var(--cds-heading-03-font-weight, 400);line-height:var(--cds-heading-03-line-height, 1.4);letter-spacing:var(--cds-heading-03-letter-spacing, 0);color:#525252}.-esm-patient-forms__forms-list__desktopHeading___H0ZOv,.-esm-patient-forms__forms-list__tabletHeading___WoN_X{text-align:left;text-transform:capitalize;margin-bottom:1rem}.-esm-patient-forms__forms-list__desktopHeading___H0ZOv h4:after,.-esm-patient-forms__forms-list__tabletHeading___WoN_X h4:after{content:"";display:block;width:2rem;padding-top:.188rem;border-bottom:.375rem solid var(--brand-03)}.-esm-patient-forms__forms-list__heading___CM6tO:after{content:"";display:block;width:2rem;padding-top:.188rem;border-bottom:.375rem solid var(--brand-03)}',"",{version:3,sources:["webpack://./../../node_modules/@openmrs/esm-styleguide/src/_vars.scss","webpack://./src/forms/forms-list.scss","webpack://./../../node_modules/@carbon/layout/scss/generated/_spacing.scss","webpack://./../../node_modules/@carbon/type/scss/_styles.scss"],names:[],mappings:"AAoDA,MACE,mBAAA,CACA,mBAAA,CACA,mBAAA,CClDF,mDACE,YAAA,CACA,wBDPM,CCUR,yEACE,MAAA,CAGF,uDACE,YAAA,CACA,6BAAA,CAGF,wDACE,iBAAA,CACA,YAAA,CACA,WC6BW,CD5BX,wBAAA,CAGF,sDACE,SAAA,CACA,iBAAA,CAIA,sDACE,yBAAA,CAGF,yEACE,YAAA,CACA,gBAAA,CAGF,gFACE,qBAAA,CAKF,kEACE,kBAAA,CAIJ,iDACE,oBAAA,CAGF,iDACE,iBAAA,CACA,YAAA,CACA,UAAA,CACA,eAAA,CACA,mBAAA,CAGF,wDACE,sBAAA,CACA,kBAAA,CACA,UAAA,CACA,YAAA,CAGF,wDACE,SAAA,CAEA,iFACE,wBAAA,CACA,kBAAA,CACA,gBAAA,CAGF,4EACE,iBAAA,CACA,WAAA,CACA,eAAA,CACA,gBAAA,CACA,KAAA,CAGF,kFACE,gBAAA,CAIJ,yDACE,MAAA,CAEA,yFACE,KAAA,CAGF,mFACE,WAAA,CAIJ,uDACE,qBDzGM,CC0GN,4BAAA,CACA,cAAA,CAGF,8CACE,WAAA,CACA,iBAAA,CAGF,iDEstBI,uDAAA,CAAA,0DAAA,CAAA,4DAAA,CAAA,8DAAA,CFptBF,aDjHQ,CCkHR,mBAAA,CAGF,qDACE,YAAA,CACA,qBAAA,CACA,kBAAA,CAGF,oDACE,iBAAA,CACA,wBAAA,CAGF,2DEqsBI,2DAAA,CAAA,0DAAA,CAAA,8DAAA,CAAA,mEAAA,CFnsBF,aDlIQ,CCmIR,eCzGW,CD0GX,mBCpHW,CDwHX,2DE6rBE,uDAAA,CAAA,0DAAA,CAAA,4DAAA,CAAA,8DAAA,CF3rBA,aD1IM,CC+IR,0DEsrBE,kDAAA,CAAA,kDAAA,CAAA,kDAAA,CAAA,sDAAA,CFprBA,aDjJM,CCqJV,+GACE,eAAA,CACA,yBAAA,CACA,kBC9HW,CDgIX,iIACE,UAAA,CACA,aAAA,CACA,UAAA,CACA,mBAAA,CACA,2CAAA,CAIJ,uDACE,UAAA,CACA,aAAA,CACA,UAAA,CACA,mBAAA,CACA,2CAAA",sourceRoot:""}]),a.locals={container:"-esm-patient-forms__forms-list__container___xgwVa",backgroundDataFetchingIndicator:"-esm-patient-forms__forms-list__backgroundDataFetchingIndicator___sBW6B",flexContainer:"-esm-patient-forms__forms-list__flexContainer___kG5Iq",toolbarWrapper:"-esm-patient-forms__forms-list__toolbarWrapper___ZzsNI",tableToolbar:"-esm-patient-forms__forms-list__tableToolbar___ObNDb",search:"-esm-patient-forms__forms-list__search___hzYIS",table:"-esm-patient-forms__forms-list__table___QQOPl",heading:"-esm-patient-forms__forms-list__heading___CM6tO",toolbar:"-esm-patient-forms__forms-list__toolbar___sm5JG",emptyContainer:"-esm-patient-forms__forms-list__emptyContainer___MAOhX",tableContainer:"-esm-patient-forms__forms-list__tableContainer___wBefR",filterContainer:"-esm-patient-forms__forms-list__filterContainer___MGW4a",tileContainer:"-esm-patient-forms__forms-list__tileContainer___INhlH",tile:"-esm-patient-forms__forms-list__tile___hxTl4",content:"-esm-patient-forms__forms-list__content___ESb5d",tileContent:"-esm-patient-forms__forms-list__tileContent___DjLG8",emptyState:"-esm-patient-forms__forms-list__emptyState___msVPw",emptyStateContent:"-esm-patient-forms__forms-list__emptyStateContent___D36gX",desktopHeading:"-esm-patient-forms__forms-list__desktopHeading___H0ZOv",tabletHeading:"-esm-patient-forms__forms-list__tabletHeading___WoN_X"};const i=a},2292:(e,t,n)=>{n.d(t,{Z:()=>i});var r=n(272),o=n.n(r),s=n(2609),a=n.n(s)()(o());a.push([e.id,".-esm-patient-forms__forms-workspace__container___FFyWY{height:100vh}","",{version:3,sources:["webpack://./src/forms/forms-workspace.scss"],names:[],mappings:"AAAA,wDACE,YAAA",sourceRoot:""}]),a.locals={container:"-esm-patient-forms__forms-workspace__container___FFyWY"};const i=a},2767:(e,t,n)=>{n.r(t),n.d(t,{default:()=>W});var r=n(268),o=n.n(r),s=n(906),a=n(6217),i=n(4924),m=n(9377),l=n(7386),A=n(9871),_=n(1354),c=n.n(_),d=n(1583),f=n.n(d),p=n(7378),u=n.n(p),C=n(3927),h=n.n(C),g=n(4154),v=n.n(g),b=n(8141),E=n.n(b),y=n(6726),D={};D.styleTagTransform=E(),D.setAttributes=h(),D.insert=u().bind(null,"head"),D.domAPI=f(),D.insertStyleElement=v(),c()(y.Z,D);const w=y.Z&&y.Z.locals?y.Z.locals:void 0;function F(){return F=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},F.apply(this,arguments)}const B=function(e){var t,n=e.currentVisit,_=e.htmlFormEntryForms,c=e.patient,d=e.patientUuid,f=(0,i.useTranslation)().t,p=(0,A.MS)(d),u=p.data,C=p.error,h=p.mutateForms,g="tablet"===(0,s.useLayoutType)(),v=(0,r.useCallback)((function(e,t,r){(0,l.U)(n,e,c,_,t,r,h)}),[n,_,h,c]),b=[{header:f("formName","Form name (A-Z)"),key:"formName"},{header:f("lastCompleted","Last completed"),key:"lastCompleted"}],E=(0,r.useMemo)((function(){return null==u?void 0:u.map((function(e){var t,n;return{id:e.form.uuid,lastCompleted:e.lastCompleted?(0,s.formatDatetime)(e.lastCompleted):void 0,formName:null!==(n=e.form.display)&&void 0!==n?n:e.form.name,formUuid:e.form.uuid,encounterUuid:null===(t=null==e?void 0:e.associatedEncounters[0])||void 0===t?void 0:t.uuid}}))}),[u]);return u||C?0===(null==u?void 0:u.length)?o().createElement(m.mh4,null,o().createElement(m.n9L,{className:w.emptyState},o().createElement("div",{className:g?w.tabletHeading:w.desktopHeading},o().createElement("h4",null,f("forms","Forms"))),o().createElement(a.EmptyDataIllustration,null),o().createElement("p",{className:w.emptyStateContent},f("noFormsToDisplay","There are no forms to display.")))):o().createElement(m.wQF,{rows:E,headers:b,size:g?"lg":"sm",useZebraStyles:!0},(function(e){var n=e.rows,r=e.headers,s=e.getTableProps,a=e.getHeaderProps,i=e.getRowProps,l=e.onInputChange;return o().createElement(o().Fragment,null,o().createElement(m.xJi,{className:w.tableContainer},o().createElement("div",{className:w.toolbarWrapper},o().createElement(m.fjU,{className:w.tableToolbar},o().createElement(m.Vj0,null,o().createElement(m.Ys1,{className:w.search,expanded:!0,onChange:l,placeholder:f("searchThisList","Search this list"),size:"sm"})))),o().createElement(m.iA_,F({},s(),{className:w.table}),o().createElement(m.ssF,null,o().createElement(m.SCH,null,r.map((function(e){return o().createElement(m.xDH,F({},a({header:e})),e.header)})))),o().createElement(m.RMI,null,n.map((function(e,n){var r;return o().createElement(m.SCH,F({},i({row:e})),o().createElement(m.pj1,{key:e.cells[0].id},o().createElement(m.rUS,{style:{cursor:"pointer"},onClick:function(){v(e.id,"",E[n].formName)},role:"presentation",className:w.formName},null===(r=E[n])||void 0===r?void 0:r.formName)),o().createElement(m.pj1,{className:w.editCell},o().createElement("label",null,null!==(t=e.cells[1].value)&&void 0!==t?t:f("never","Never"))))}))))),0===(null==n?void 0:n.length)?o().createElement("div",{className:w.tileContainer},o().createElement(m.n9L,{className:w.tile},o().createElement("div",{className:w.tileContent},o().createElement("p",{className:w.content},f("noMatchingFormsToDisplay","No matching forms to display")),o().createElement("p",{className:w.helper},f("checkFilters","Check the filters above"))))):null)})):o().createElement(m.gqd,{role:"progressbar"})};var k=n(2924),N={};N.styleTagTransform=E(),N.setAttributes=h(),N.insert=u().bind(null,"head"),N.domAPI=f(),N.insertStyleElement=v(),c()(k.Z,N);const I=k.Z&&k.Z.locals?k.Z.locals:void 0,H=function(){var e=(0,s.useConfig)().htmlFormEntryForms,t=(0,s.usePatient)(),n=t.patient,r=t.patientUuid,i=(0,a.useVisitOrOfflineVisit)(r).currentVisit;return o().createElement("div",{className:I.container},o().createElement(B,{currentVisit:i,htmlFormEntryForms:e,patient:n,patientUuid:r}))};var S=n(2292),x={};x.styleTagTransform=E(),x.setAttributes=h(),x.insert=u().bind(null,"head"),x.domAPI=f(),x.insertStyleElement=v(),c()(S.Z,x);const G=S.Z&&S.Z.locals?S.Z.locals:void 0;function W(){return o().createElement("div",{className:G.container},o().createElement(H,null))}},9871:(e,t,n)=>{n.d(t,{MS:()=>p,cq:()=>d});var r=n(5047),o=n.n(r),s=n(3565),a=n.n(s),i=n(3255),m=n(906),l=n(3871),A=n(5543);function _(e,t,n,r,o,s,a){try{var i=e[s](a),m=i.value}catch(e){return void n(e)}i.done?t(m):Promise.resolve(m).then(r,o)}function c(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var s=e.apply(t,n);function a(e){_(s,r,o,a,i,"next",e)}function i(e){_(s,r,o,a,i,"throw",e)}a(void 0)}))}}function d(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=(0,m.useConfig)(),r=n.showConfigurableForms,s=n.customFormsUrl,a=n.showHtmlFormEntryForms,A=r?s.concat("?patientUuid=".concat(t)):a?l.lA:l.HW;return(0,i.ZP)([A,e],c(o().mark((function t(){var n,s,a,i,l,_;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=3,(0,m.openmrsFetch)(A);case 3:if(a=t.sent,l=r?null==a?void 0:a.data.results:null!==(i=null===(n=a.data)||void 0===n||null===(s=n.results)||void 0===s?void 0:s.filter((function(e){return e.published&&!/component/i.test(e.name)})))&&void 0!==i?i:[],e){t.next=8;break}return t.abrupt("return",l);case 8:return t.next=10,(0,m.getDynamicOfflineDataEntries)("form");case 10:return _=t.sent,t.abrupt("return",l.filter((function(e){return _.some((function(t){return t.identifier===e.uuid}))})));case 12:case"end":return t.stop()}}),t)}))))}function f(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:a()(new Date).startOf("day").subtract(500,"day").toDate(),n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:a()(new Date).endOf("day").toDate(),r="/ws/rest/v1/encounter?v=".concat(l._V,"&patient=").concat(e,"&fromdate=").concat(t.toISOString(),"&todate=").concat(n.toISOString());return(0,i.ZP)(r,(function(e){return(0,m.openmrsFetch)(e)}))}function p(e,t,n){var r,o,s,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=(0,m.useConfig)().htmlFormEntryForms,l=d(a,e),_=f(e,t,n),c=null!==(s=null===(r=_.data)||void 0===r||null===(o=r.data)||void 0===o?void 0:o.results)&&void 0!==s?s:[],p=l.data?u(l.data,c):void 0,C=(0,m.useSession)(),h=function(){l.mutate(),_.mutate()},g=a?null==p?void 0:p.filter((function(e){return(0,A.LD)(e.form,i)})):p;return(null==C?void 0:C.user)&&(g=null==g?void 0:g.filter((function(e){var t,n,r;return(0,m.userHasAccess)(null==e||null===(t=e.form)||void 0===t||null===(n=t.encounterType)||void 0===n||null===(r=n.editPrivilege)||void 0===r?void 0:r.display,C.user)}))),{data:g,error:l.error,isValidating:l.isValidating||_.isValidating,allForms:l.data,mutateForms:h}}function u(e,t){return e.map((function(e){var n=t.filter((function(t){var n;return(null===(n=t.form)||void 0===n?void 0:n.uuid)===(null==e?void 0:e.uuid)})).sort((function(e,t){var n,r;return(null===(n=e.form)||void 0===n?void 0:n.display)>(null===(r=t.form)||void 0===r?void 0:r.display)?1:-1})),r=n.length>0?new Date(null==n?void 0:n[0].encounterDatetime):void 0;return{form:e,associatedEncounters:n,lastCompleted:r}}))}},5543:(e,t,n)=>{n.d(t,{LD:()=>s,nY:()=>i});var r=n(3255),o=n(906);function s(e,t){var n=t.some((function(t){return t.formUuid===e.uuid})),r=e.resources.some(a);return!n&&r}function a(e){return"AmpathJsonSchema"===e.dataType||"JSON schema"===e.name}function i(){return(0,r.ZP)("dynamicFormEntries",(function(){return(0,o.getDynamicOfflineDataEntries)("form")}))}}}]);