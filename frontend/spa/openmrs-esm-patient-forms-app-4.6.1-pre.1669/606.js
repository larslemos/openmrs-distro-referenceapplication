(globalThis.webpackChunk_openmrs_esm_patient_forms_app=globalThis.webpackChunk_openmrs_esm_patient_forms_app||[]).push([[606,217],{3871:(e,t,r)=>{"use strict";r.d(t,{HW:()=>a,Vh:()=>s,_V:()=>o,dr:()=>c,lA:()=>i});var n="(uuid,name,display,encounterType:(uuid,name,viewPrivilege,editPrivilege),version,published,retired,resources:(uuid,name,dataType,valueReference))",o="custom:(uuid,encounterDatetime,encounterType:(uuid,name,viewPrivilege,editPrivilege),form:".concat(n),i="/ws/rest/v1/form?v=custom:".concat(n),a="/ws/rest/v1/form?v=custom:".concat(n,"&q=poc"),s="clinical-forms-workspace",c="patient-form-entry-workspace"},7386:(e,t,r)=>{"use strict";r.d(t,{K:()=>s,U:()=>a});var n=r(906),o=r(7279),i=r(6217);function a(e,t,r,a,c,f,l){if(e){var u=a.find((function(e){return e.formUuid===t}));(0,o.Z)(u)?s(t,r.id,c,f,l,e):(0,n.navigate)({to:"${openmrsBase}/htmlformentryui/htmlform/".concat(u.formUiPage,".page?patientId=").concat(r.id,"&visitId=").concat(e.uuid,"&definitionUiResource=").concat(u.formUiResource,"&returnUrl=").concat(window.location.href)})}else(0,i.launchStartVisitPrompt)()}function s(e,t,r,n,o,a){i.formEntrySub.next({formUuid:e,encounterUuid:r}),(0,i.launchPatientWorkspace)("patient-form-entry-workspace",{workspaceTitle:n,mutateForm:o,formUuid:e,encounterUuid:r,visit:a})}},7606:(e,t,r)=>{"use strict";r.r(t),r.d(t,{backendDependencies:()=>N,importTranslation:()=>W,setupOpenMRS:()=>E,version:()=>H});var n=r(906),o=r(6217),i={htmlFormEntryForms:{_type:n.Type.Array,_elements:{formUuid:{_type:n.Type.String,_description:"The UUID of the form"},formName:{_type:n.Type.String,_description:"The name of the form"},formUiResource:{_type:n.Type.String,_description:'The resource file that defines the form. For example "referenceapplication:htmlforms/vitals.xml"'},formUiPage:{_type:n.Type.String,_description:'The HTMLFormEntry page to use to show this form. Should be one of "enterHtmlFormWithStandardUi" or "enterHtmlFormWithSimpleUi"',_validators:[(0,n.validator)((function(e){return"enterHtmlFormWithStandardUi"===e||"enterHtmlFormWithSimpleUi"===e}),'Must be one of "enterHtmlFormWithStandardUi" or "enterHtmlFormWithSimpleUi"')]}},_default:[{formUuid:"d2c7532c-fb01-11e2-8ff2-fd54ab5fdb2a",formName:"Admission (Simple)",formUiResource:"referenceapplication:htmlforms/simpleAdmission.xml",formUiPage:"enterHtmlFormWithStandardUi"},{formUuid:"b5f8ffd8-fbde-11e2-8ff2-fd54ab5fdb2a",formName:"Discharge (Simple)",formUiResource:"referenceapplication:htmlforms/simpleDischarge.xml",formUiPage:"enterHtmlFormWithStandardUi"},{formUuid:"a007bbfe-fbe5-11e2-8ff2-fd54ab5fdb2a",formName:"Transfer Within Hospital (Simple)",formUiResource:"referenceapplication:htmlforms/simpleTransfer.xml",formUiPage:"enterHtmlFormWithStandardUi"},{formUuid:"c75f120a-04ec-11e3-8780-2b40bef9a44b",formName:"Visit Note",formUiResource:"referenceapplication:htmlforms/simpleVisitNote.xml",formUiPage:"enterHtmlFormWithStandardUi"},{formUuid:"a000cb34-9ec1-4344-a1c8-f692232f6edd",formName:"Vitals",formUiResource:"referenceapplication:htmlforms/vitals.xml",formUiPage:"enterHtmlFormWithSimpleUi"}]},showHtmlFormEntryForms:{_type:n.Type.Boolean,_default:!0,_description:"Whether HTML Form Entry forms should be included in lists of forms."},showRecommendedFormsTab:{_type:n.Type.Boolean,_description:"Whether to display recommended forms tab. Requires AMPATH ETL.",_default:!1},showConfigurableForms:{_type:n.Type.Boolean,_description:"Whether to use customURL to fetch forms, works with `customFormsUrl`",_default:!1},customFormsUrl:{_type:n.Type.String,_description:"Custom forms endpoint to fetch forms using a custom url need `showConfigurableForms`",_default:""},orderFormsByName:{_type:n.Type.Boolean,_description:"Order forms alphabetically.",_default:!0}},a={slot:"patient-chart-form-dashboard-slot",columns:1,path:"Forms & Notes"},s=r(5047),c=r.n(s),f=r(7386),l=r(3871),u=r(8407);function m(e,t,r,n,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(n,o)}function p(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(e){m(i,n,o,a,s,"next",e)}function s(e){m(i,n,o,a,s,"throw",e)}a(void 0)}))}}function d(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function h(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){d(e,t,r[t])}))}return e}function y(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r.push.apply(r,n)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}var b="patient-form";function v(){return(v=p(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(0,n.setupOfflineSync)(b,["visit"],w,{onBeginEditSyncItem:function(e){(0,f.K)(e.content.formSchemaUuid,e.descriptor.patientUuid,e.content._id,"Form Entry")}});case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function w(e,t){return g.apply(this,arguments)}function g(){return(g=p(c().mark((function e(t,r){var n,o,i,a;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.dependencies[0],o=t._payloads,i=o.encounterCreate,a=o.personUpdate,e.next=4,Promise.all([O(n,i),P(null==a?void 0:a.uuid,a)]);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function O(e,t){return U.apply(this,arguments)}function U(){return(U=p(c().mark((function e(t,r){var o,i;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r){e.next=2;break}return e.abrupt("return");case 2:return i=y(h({},r),{encounterDatetime:null!==(o=r.encounterDatetime)&&void 0!==o?o:null==t?void 0:t.stopDatetime}),e.next=6,(0,n.openmrsFetch)("/ws/rest/v1/encounter",{headers:{"Content-Type":"application/json"},method:"POST",body:i});case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function P(e,t){return k.apply(this,arguments)}function k(){return(k=p(c().mark((function e(t,r){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&r){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,(0,n.openmrsFetch)("/ws/rest/v1/person/".concat(t),{headers:{"Content-Type":"application/json"},method:"POST",body:r});case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function S(){return S=p(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(0,n.setupDynamicOfflineDataHandler)({id:"esm-patient-forms-app:form",type:"form",displayName:"Patient forms",isSynced:function(e){return p(c().mark((function t(){var r,o,i,a;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,_(e);case 2:return r=t.sent,o=r.map((function(e){return window.origin+(0,n.makeUrl)(e)})),t.next=6,caches.open("omrs-spa-cache-v1");case 6:return i=t.sent,t.next=9,i.keys();case 9:return a=t.sent.map((function(e){return e.url})),t.abrupt("return",o.every((function(e){return a.includes(e)})));case 11:case"end":return t.stop()}}),t)})))()},sync:function(e){return p(c().mark((function t(){var r;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,_(e);case 2:return r=t.sent,t.next=5,Promise.allSettled(r.map(function(){var e=p(c().mark((function e(t){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,n.messageOmrsServiceWorker)({type:"registerDynamicRoute",pattern:(0,u.Z)(t),strategy:"network-first"});case 2:return e.next=4,(0,n.openmrsFetch)(t,{headers:d({},n.omrsOfflineCachingStrategyHttpHeaderName,"network-first")});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 5:if(!t.sent.some((function(e){return"rejected"===e.status}))){t.next=8;break}throw new Error("Some form data could not be properly downloaded. (Form UUID: ".concat(e,")"));case 8:case"end":return t.stop()}}),t)})))()}});case 1:case"end":return e.stop()}}),e)}))),S.apply(this,arguments)}function _(e){return F.apply(this,arguments)}function F(){return(F=p(c().mark((function e(t){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,n.openmrsFetch)("/ws/rest/v1/form/".concat(t,"?v=full"));case 2:if(e.sent.data){e.next=6;break}throw new Error("The form data could not be loaded from the server. (Form UUID: ".concat(t,")"));case 6:return e.abrupt("return",[l.lA,l.HW].filter(Boolean));case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var j=r(268),x=r.n(j);function T(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function D(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){T(e,t,r[t])}))}return e}var H="4.6.1-pre.1669",W=r(3979),N={"webservices.rest":"^2.2.0"};function E(){var e,t,s,c="@openmrs/esm-patient-forms-app",f={featureName:"patient-forms",moduleName:c};return(0,n.defineConfigSchema)(c,i),(0,n.registerBreadcrumbs)([{path:"".concat(window.spaBase,"/offline-tools/forms"),title:"Offline forms",parent:"".concat(window.spaBase,"/offline-tools")}]),function(){v.apply(this,arguments)}(),function(){S.apply(this,arguments)}(),(0,n.subscribePrecacheStaticDependencies)((function(){return(0,n.syncAllDynamicOfflineData)("form")})),(0,o.registerWorkspace)({name:"patient-form-entry-workspace",title:"Clinical Form",load:(0,n.getAsyncLifecycle)((function(){return r.e(407).then(r.bind(r,2407))}),f)}),{extensions:[{name:"patient-form-dashboard",order:0,slot:a.slot,load:(0,n.getAsyncLifecycle)((function(){return Promise.all([r.e(34),r.e(255),r.e(924),r.e(565),r.e(993)]).then(r.bind(r,5993))}),f),online:{isOffline:!1},offline:{isOffline:!0}},{name:"forms-summary-dashboard",slot:"patient-chart-dashboard-slot",order:12,load:(0,n.getSyncLifecycle)((0,o.createDashboardLink)((t=D({},a),s={title:function(){var t;return Promise.resolve(null!==(e=null===(t=window.i18next)||void 0===t?void 0:t.t("forms_link",{defaultValue:"Forms & Notes",ns:c}))&&void 0!==e?e:"Forms & Notes")}},s=null!=s?s:{},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r.push.apply(r,n)}return r}(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))})),t)),f),meta:a,online:!0,offline:!0},{name:"offline-tools-dashboard-forms-card",slot:"offline-tools-dashboard-cards",load:(0,n.getAsyncLifecycle)((function(){return Promise.all([r.e(34),r.e(255),r.e(924),r.e(505)]).then(r.bind(r,505))}),f),online:!0,offline:!0,order:1},{name:"offline-tools-page-forms-link",slot:"offline-tools-page-slot",load:(0,n.getSyncLifecycle)((function(){return t=(e={page:"forms",title:"Offline forms"}).page,r=e.title,x().createElement("div",{key:t},x().createElement(n.ConfigurableLink,{to:"${openmrsSpaBase}/offline-tools"+(t?"/".concat(t):""),className:"cds--side-nav__link"},r));var e,t,r}),f),meta:{name:"forms",slot:"offline-tools-page-forms-slot"},online:!0,offline:!0},{name:"offline-tools-page-forms",slot:"offline-tools-page-forms-slot",load:(0,n.getAsyncLifecycle)((function(){return Promise.all([r.e(34),r.e(255),r.e(924),r.e(565),r.e(363)]).then(r.bind(r,4363))}),f),online:{canMarkFormsAsOffline:!0},offline:{canMarkFormsAsOffline:!1}},{name:"clinical-form-action-menu",slot:"action-menu-chart-items-slot",load:(0,n.getAsyncLifecycle)((function(){return Promise.all([r.e(34),r.e(525),r.e(924),r.e(332)]).then(r.bind(r,8332))}),f),order:2},{name:"clinical-forms-workspace",load:(0,n.getAsyncLifecycle)((function(){return Promise.all([r.e(34),r.e(255),r.e(924),r.e(565),r.e(767)]).then(r.bind(r,2767))}),f),meta:{title:{key:"clinicalForm",default:"Clinical form"},type:"order"}}]}}},3979:(e,t,r)=>{var n={"./en.json":[3574,574],"./fr.json":[2757,757],"./he.json":[5833,833],"./km.json":[7807,807]};function o(e){if(!r.o(n,e))return Promise.resolve().then((()=>{var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=n[e],o=t[0];return r.e(t[1]).then((()=>r(o)))}o.keys=()=>Object.keys(n),o.id=3979,e.exports=o}}]);