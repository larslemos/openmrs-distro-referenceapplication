"use strict";(globalThis.webpackChunk_openmrs_esm_patient_programs_app=globalThis.webpackChunk_openmrs_esm_patient_programs_app||[]).push([[291],{7763:(e,t,r)=>{r.d(t,{Z:()=>i});var n=r(272),o=r.n(n),a=r(2609),l=r.n(a)()(o());l.push([e.id,":root{--brand-01: #005d5d;--brand-02: #004144;--brand-03: #007d79}.-esm-patient-programs__programs-overview__widgetCard___yEo1t{border:1px solid #e0e0e0}","",{version:3,sources:["webpack://./../../node_modules/@openmrs/esm-styleguide/src/_vars.scss","webpack://./src/programs/programs-overview.scss"],names:[],mappings:"AAoDA,MACE,mBAAA,CACA,mBAAA,CACA,mBAAA,CCrDF,8DACE,wBAAA",sourceRoot:""}]),l.locals={widgetCard:"-esm-patient-programs__programs-overview__widgetCard___yEo1t"};const i=l},4291:(e,t,r)=>{r.r(t),r.d(t,{default:()=>T});var n=r(268),o=r.n(n),a=r(4924),l=r(3315),i=r(7289),s=r(6759),c=r(6217),d=r(906),u=r(1470),m=r(6039);function p(){return p=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},p.apply(this,arguments)}const g=function(e){var t=e.enrollment,r=(0,a.useTranslation)().t,n="tablet"===(0,d.useLayoutType)(),l="eligible"===t.enrollmentStatus?t.enrollmentFormUuid:t.discontinuationFormUuid,s=function(e){c.formEntrySub.next({formUuid:l,encounterUuid:""}),(0,c.launchPatientWorkspace)("patient-form-entry-workspace",{workspaceTitle:"".concat(null==t?void 0:t.display," ").concat(e," Form")})};return"eligible"===t.enrollmentStatus?o().createElement(i.zxk,{iconDescription:r("enrollProgram","Enroll to program"),onClick:function(){return s(r("enrollment","Enrollment"))},renderIcon:function(e){return o().createElement(m.sQ,p({size:20},e))},kind:"tertiary",size:n?"lg":"sm",tooltipPosition:"left"},r("enroll","Enroll")):o().createElement(i.zxk,{iconDescription:r("discontinueEnrollment","Discontinue enrollment"),onClick:function(){return s(r("discontinue","Discontinue"))},renderIcon:function(e){return o().createElement(m.sQ,p({size:20},e))},kind:"danger--ghost",size:n?"lg":"sm",tooltipPosition:"left"},r("discontinue","Discontinue"))};var v=r(1354),b=r.n(v),f=r(1583),E=r.n(f),h=r(7378),y=r.n(h),P=r(5993),C=r.n(P),w=r(4154),k=r.n(w),O=r(8141),A=r.n(O),_=r(7763),S={};S.styleTagTransform=A(),S.setAttributes=C(),S.insert=y().bind(null,"head"),S.domAPI=E(),S.insertStyleElement=k(),b()(_.Z,S);const j=_.Z&&_.Z.locals?_.Z.locals:void 0;function D(){return D=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},D.apply(this,arguments)}const T=function(e){e.basePath;var t,r,n=e.patientUuid,m=(0,a.useTranslation)().t,p=(0,d.useConfig)(),v=m("programs","Program enrollments"),b=m("carePrograms","Care Programs"),f=m("seeAll","See all"),E="${openmrsSpaBase}/patient/".concat(n,"/chart/Programs"),h=!!p.customUrl,y=(0,d.useLayoutType)(),P="tablet"===y,C=(0,d.isDesktop)(y),w=(0,u.b$)(n),k=w.activeEnrollments,O=w.availablePrograms,A=w.configurablePrograms,_=w.eligiblePrograms,S=w.enrollments,T=w.isError,L=w.isLoading,Z=w.isValidating,F=(0,d.usePagination)(h?A:null!=S?S:[],5),z=F.results,x=F.goTo,U=F.currentPage,I=o().useCallback((function(){return(0,c.launchPatientWorkspace)("programs-form-workspace")}),[]),B=[{key:"display",header:m("activePrograms","Active programs")},{key:"location",header:m("location","Location")},{key:"dateEnrolled",header:m("dateEnrolled","Date enrolled")},{key:"status",header:m("status","Status")},{key:"actions",header:m("actions","Actions")}],H=o().useMemo((function(){var e;return null==z?void 0:z.map((function(t){var r;return{id:t.uuid,display:t.display,location:null!==(e=null===(r=t.location)||void 0===r?void 0:r.display)&&void 0!==e?e:"--",dateEnrolled:t.dateEnrolled?(0,d.formatDatetime)(new Date(t.dateEnrolled)):"--",status:h?(0,l.Z)(t.enrollmentStatus):t.dateCompleted?"".concat(m("completedOn","Completed On")," ").concat((0,d.formatDate)(new Date(t.dateCompleted))):m("active","Active"),actions:o().createElement(g,{enrollment:t})}}))}),[h,z,m]);return L?o().createElement(i.gqd,{role:"progressbar",compact:C,zebra:!0}):T?o().createElement(c.ErrorState,{error:T,headerTitle:b}):(h?A.length:null==k?void 0:k.length)?o().createElement("div",{className:j.widgetCard},o().createElement(c.CardHeader,{title:b},o().createElement("span",null,Z?o().createElement(i.lSo,null):null),p.hideAddProgramButton?null:o().createElement(i.zxk,{kind:"ghost",renderIcon:function(e){return o().createElement(s.mm,D({size:16},e))},iconDescription:"Add programs",onClick:I,disabled:(null==O?void 0:O.length)&&0===(null==_?void 0:_.length)},m("add","Add"))),(null==O?void 0:O.length)&&0===(null==_?void 0:_.length)&&o().createElement(i.K0D,{style:{minWidth:"100%",margin:"0rem",padding:"0rem"},kind:"info",lowContrast:!0,subtitle:m("noEligibleEnrollments","There are no more programs left to enroll this patient in"),title:m("fullyEnrolled","Enrolled in all programs")}),o().createElement(i.wQF,{rows:H,headers:B,isSortable:!0,size:P?"lg":"sm",useZebraStyles:!0},(function(e){var n=e.rows,a=e.headers,l=e.getHeaderProps,s=e.getTableProps;return o().createElement(i.xJi,null,o().createElement(i.iA_,D({},s()),o().createElement(i.ssF,null,o().createElement(i.SCH,null,a.map((function(e){var r;return o().createElement(i.xDH,D({className:"".concat(j.productiveHeading01," ").concat(j.text02)},l({header:e,isSortable:e.isSortable})),null!==(t=null===(r=e.header)||void 0===r?void 0:r.content)&&void 0!==t?t:e.header)})))),o().createElement(i.RMI,null,n.map((function(e){return o().createElement(i.SCH,{key:e.id},e.cells.map((function(e){var t;return o().createElement(i.pj1,{key:e.id},null!==(r=null===(t=e.value)||void 0===t?void 0:t.content)&&void 0!==r?r:e.value)})))})))))})),o().createElement(c.PatientChartPagination,{currentItems:z.length,onPageNumberChange:function(e){var t=e.page;return x(t)},pageNumber:U,pageSize:5,totalItems:h?A.length:null==S?void 0:S.length,dashboardLinkUrl:E,dashboardLinkLabel:f})):o().createElement(c.EmptyState,{displayText:v,headerTitle:b,launchForm:I})}},1470:(e,t,r)=>{r.d(t,{Bw:()=>d,YX:()=>p,b$:()=>g,df:()=>m,oI:()=>u});var n=r(3255),o=r(906),a=r(4221),l=r(9626),i=r(3139),s=r(6772);function c(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function d(e){var t,r="/ws/rest/v1/programenrollment?patient=".concat(e,"&v=").concat("custom:(uuid,display,program,dateEnrolled,dateCompleted,location:(uuid,display))"),l=(0,n.ZP)(e?r:null,o.openmrsFetch),i=l.data,s=l.error,c=l.isLoading,d=l.isValidating,u=l.mutate,m=(null==i||null===(t=i.data)||void 0===t?void 0:t.results.length)>0?null==i?void 0:i.data.results.sort((function(e,t){return t.dateEnrolled>e.dateEnrolled?1:-1})):null,p=null==m?void 0:m.filter((function(e){return!e.dateCompleted}));return{data:i?(0,a.Z)(m,(function(e){var t;return null==e||null===(t=e.program)||void 0===t?void 0:t.uuid})):null,isError:s,isLoading:c,isValidating:d,activeEnrollments:p,mutateEnrollments:u}}function u(e){var t,r,a=(0,n.ZP)("/ws/rest/v1/program?v=custom:(uuid,display,allWorkflows,concept:(uuid,display))",o.openmrsFetch),c=a.data,d=a.error,u=a.isLoading,m=null!==(r=null==c||null===(t=c.data)||void 0===t?void 0:t.results)&&void 0!==r?r:null;return{data:m,isError:d,isLoading:u,eligiblePrograms:(0,l.Z)(m,(function(t){return!(0,i.Z)((0,s.Z)(e,"program.uuid"),t.uuid)}))}}function m(e,t){if(!e)return null;var r=e.program,n=e.patient,a=e.dateEnrolled,l=e.dateCompleted,i=e.location;return(0,o.openmrsObservableFetch)("/ws/rest/v1/programenrollment",{method:"POST",headers:{"Content-Type":"application/json"},body:{program:r,patient:n,dateEnrolled:a,dateCompleted:l,location:i},signal:t.signal})}function p(e,t,r){if(!t&&!t.program)return null;t.program;var n=t.dateEnrolled,a=t.dateCompleted,l=t.location;return(0,o.openmrsObservableFetch)("/ws/rest/v1/programenrollment/".concat(e),{method:"POST",headers:{"Content-Type":"application/json"},body:{dateEnrolled:n,dateCompleted:a,location:l},signal:r.signal})}var g=function(e){var t,r,a=(0,o.useConfig)().customUrl,l=d(e),i=l.data,s=l.isError,m=l.isLoading,p=l.isValidating,g=l.activeEnrollments,v=u(i),b=v.data,f=v.eligiblePrograms,E=function(e){var t,r=(0,o.useConfig)().customUrl,a=(0,n.ZP)(r?"".concat(r).concat(e):null,o.openmrsFetch),l=a.data,i=a.error,s=a.isLoading;return{configurablePrograms:null!==(t=null==l?void 0:l.data)&&void 0!==t?t:[],isLoading:s,error:i}}(e),h=E.configurablePrograms,y=E.isLoading,P=E.error;return t=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){c(e,t,r[t])}))}return e}({enrollments:i},a?{isLoading:y,isError:P}:{isLoading:m,isError:s}),r=null!=(r={isValidating:p,activeEnrollments:g,availablePrograms:b,eligiblePrograms:f,configurablePrograms:h})?r:{},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r.push.apply(r,n)}return r}(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})),t}}}]);